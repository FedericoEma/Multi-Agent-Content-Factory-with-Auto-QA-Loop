{
  "name": "Multi-Agent Content Factory with Auto-QA Loop",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        128,
        144
      ],
      "id": "62e28e00-3439-44d7-8398-1269af073211",
      "name": "When clicking â€˜Execute workflowâ€™"
    },
    {
      "parameters": {
        "options": {
          "temperature": 0.7
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        336,
        384
      ],
      "id": "681bf119-bc90-4c2b-bc4a-f78250d47879",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "9NwljPTV1COroy6h",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Genera un brand tone e piano editoriale PROFESSIONALE per: \"Sneakers sostenibili per giovani urbani\"\n\nIl contenuto deve essere ricco, dettagliato e presentato in modo visivamente accattivante.\n\nUsa nei testi:\n- Box e separatori eleganti\n- Emoji strategiche per enfatizzare concetti\n- Linguaggio professionale ma coinvolgente\n- Descrizioni dettagliate e specifiche (non generiche)\n\nRispondi SOLO con questo JSON:\n\n{\n  \"brand_tone\": {\n    \"tono_voce\": \"Descrizione dettagliata del tono di voce (3-4 righe), con esempi di come si manifesta nella comunicazione\",\n    \"valori\": [\n      \"PRIMO VALORE - Descrizione approfondita del valore con esempi concreti di come si applica (2-3 righe)\",\n      \"SECONDO VALORE - Descrizione approfondita del valore con esempi concreti di come si applica (2-3 righe)\",\n      \"TERZO VALORE - Descrizione approfondita del valore con esempi concreti di come si applica (2-3 righe)\"\n    ],\n    \"personalita\": \"Descrizione ricca della personalitÃ  del brand (5-6 righe). Includi metafore, il 'carattere' del brand come se fosse una persona, come interagisce con il pubblico, cosa lo rende unico e memorabile\"\n  },\n  \"piano_editoriale\": {\n    \"fase_1_engagement\": {\n      \"obiettivo\": \"Descrizione dettagliata dell'obiettivo (3-4 righe) con metriche specifiche e risultati attesi\",\n      \"canali\": [\"Instagram Stories & Feed\", \"TikTok\", \"LinkedIn Articles\", \"Blog aziendale\"],\n      \"contenuti\": [\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 1\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        },\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 2\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        },\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 3\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        }\n      ],\n      \"frequenza\": \"Dettaglio frequenza: X post al giorno su Y canali, orari strategici, giorni della settimana ottimali\"\n    },\n    \"fase_2_hype\": {\n      \"obiettivo\": \"Descrizione dettagliata dell'obiettivo (3-4 righe) con metriche specifiche e risultati attesi\",\n      \"canali\": [\"Instagram Reels\", \"TikTok Live\", \"Email Marketing\", \"Partnership con Influencer\"],\n      \"contenuti\": [\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 1\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        },\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 2\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        },\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 3\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        }\n      ],\n      \"frequenza\": \"Dettaglio frequenza: X post al giorno su Y canali, orari strategici, giorni della settimana ottimali\"\n    },\n    \"fase_3_prelancio\": {\n      \"obiettivo\": \"Descrizione dettagliata dell'obiettivo (3-4 righe) con metriche specifiche e risultati attesi\",\n      \"canali\": [\"Instagram Live\", \"Email Sequences\", \"PR & Media\", \"Eventi Online\"],\n      \"contenuti\": [\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 1\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        },\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 2\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        },\n        {\n          \"tipo\": \"TITOLO CREATIVO DEL CONTENUTO 3\",\n          \"brief\": \"Brief dettagliato (4-5 righe): format specifico, tone of voice da usare, call-to-action, esempio di headline, hashtag strategici, timing di pubblicazione ottimale\"\n        }\n      ],\n      \"frequenza\": \"Dettaglio frequenza: X post al giorno su Y canali, orari strategici, giorni della settimana ottimali\"\n    }\n  }\n}\n\nIMPORTANTE:\n- Solo JSON valido\n- Non usare **, ##, o altri simboli markdown\n- Contenuti ricchi, dettagliati e professionali\n- Ogni brief deve essere specifico e actionable",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "Sei un brand strategist esperto.\nRispondi SEMPRE in formato JSON valido.\nNon aggiungere testo, spiegazioni o formattazioni markdown.\nInizia direttamente con { e termina con }\nNon usare markdown (**, ##, ecc.)."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        400,
        144
      ],
      "id": "deb3b288-440f-468d-a48f-ff0be6a94129",
      "name": "Brand Strategist",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "1FCPodmeqxEQOYLts_gsmp1OdxJMbPg91",
          "mode": "list",
          "cachedResultName": "AI AUTOMATION ULTIMO",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1FCPodmeqxEQOYLts_gsmp1OdxJMbPg91"
        },
        "event": "fileCreated",
        "options": {}
      },
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        944,
        848
      ],
      "id": "42c1e1b7-de34-4405-adaf-1051c3158529",
      "name": "Google Drive Trigger",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "wFvvoGZJDXgjFNDL",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Estrae e pulisce il JSON\nfunction extractJSON(text) {\n  text = text.replace(/```json\\s*/g, '').replace(/```\\s*/g, '');\n  const firstBrace = text.indexOf('{');\n  const lastBrace = text.lastIndexOf('}');\n  if (firstBrace === -1 || lastBrace === -1) {\n    throw new Error('Nessun JSON trovato');\n  }\n  return text.substring(firstBrace, lastBrace + 1);\n}\n\nfunction stripMarkdown(text) {\n  if (!text) return '';\n  return text.replace(/(\\*\\*|__)(.*?)\\1/g, '$2')\n             .replace(/(\\*|_)(.*?)\\1/g, '$2')\n             .replace(/`([^`]+)`/g, '$1');\n}\n\nfunction cleanObject(obj) {\n  if (typeof obj === 'string') return stripMarkdown(obj);\n  if (Array.isArray(obj)) return obj.map(item => cleanObject(item));\n  if (typeof obj === 'object' && obj !== null) {\n    const cleaned = {};\n    for (const key in obj) cleaned[key] = cleanObject(obj[key]);\n    return cleaned;\n  }\n  return obj;\n}\n\n// Parse output\nlet rawOutput = items[0].json.output || items[0].json.text || items[0].json;\nlet data;\n\nif (typeof rawOutput === 'string') {\n  data = JSON.parse(extractJSON(rawOutput));\n} else {\n  data = rawOutput;\n}\n\ndata = cleanObject(data);\n\n// FORMATTA TESTO PER GOOGLE DOCS\nlet docText = `PIANO EDITORIALE - SNEAKERS SOSTENIBILI\\n`;\ndocText += `Generato il: ${new Date().toLocaleDateString('it-IT')}\\n\\n`;\ndocText += `${'='.repeat(60)}\\n\\n`;\n\n// BRAND TONE\ndocText += `IDENTITA' DEL BRAND\\n\\n`;\ndocText += `Tono di Voce:\\n${data.brand_tone.tono_voce}\\n\\n`;\ndocText += `Valori Fondamentali:\\n`;\ndata.brand_tone.valori.forEach((val, i) => {\n  docText += `${i + 1}. ${val}\\n\\n`;\n});\ndocText += `PersonalitÃ  del Brand:\\n${data.brand_tone.personalita}\\n\\n`;\ndocText += `${'='.repeat(60)}\\n\\n`;\n\n// FASE 1\ndocText += `FASE 1: ENGAGEMENT INIZIALE\\n\\n`;\ndocText += `Obiettivo:\\n${data.piano_editoriale.fase_1_engagement.obiettivo}\\n\\n`;\ndocText += `Canali:\\n${data.piano_editoriale.fase_1_engagement.canali.join(', ')}\\n\\n`;\ndocText += `Frequenza:\\n${data.piano_editoriale.fase_1_engagement.frequenza}\\n\\n`;\ndocText += `Contenuti da Produrre:\\n`;\ndata.piano_editoriale.fase_1_engagement.contenuti.forEach((cont, i) => {\n  docText += `\\n${i + 1}. ${cont.tipo}\\n`;\n  docText += `   ${cont.brief}\\n`;\n});\ndocText += `\\n${'='.repeat(60)}\\n\\n`;\n\n// FASE 2\ndocText += `FASE 2: MANTENERE HYPE\\n\\n`;\ndocText += `Obiettivo:\\n${data.piano_editoriale.fase_2_hype.obiettivo}\\n\\n`;\ndocText += `Canali:\\n${data.piano_editoriale.fase_2_hype.canali.join(', ')}\\n\\n`;\ndocText += `Frequenza:\\n${data.piano_editoriale.fase_2_hype.frequenza}\\n\\n`;\ndocText += `Contenuti da Produrre:\\n`;\ndata.piano_editoriale.fase_2_hype.contenuti.forEach((cont, i) => {\n  docText += `\\n${i + 1}. ${cont.tipo}\\n`;\n  docText += `   ${cont.brief}\\n`;\n});\ndocText += `\\n${'='.repeat(60)}\\n\\n`;\n\n// FASE 3\ndocText += `FASE 3: PRE-LANCIO\\n\\n`;\ndocText += `Obiettivo:\\n${data.piano_editoriale.fase_3_prelancio.obiettivo}\\n\\n`;\ndocText += `Canali:\\n${data.piano_editoriale.fase_3_prelancio.canali.join(', ')}\\n\\n`;\ndocText += `Frequenza:\\n${data.piano_editoriale.fase_3_prelancio.frequenza}\\n\\n`;\ndocText += `Contenuti da Produrre:\\n`;\ndata.piano_editoriale.fase_3_prelancio.contenuti.forEach((cont, i) => {\n  docText += `\\n${i + 1}. ${cont.tipo}\\n`;\n  docText += `   ${cont.brief}\\n`;\n});\n\n// OUTPUT\nreturn [{\n  json: {\n    document_text: docText,\n    original_json: data  // JSON originale per il secondo flusso\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        752,
        144
      ],
      "id": "a6ed8932-d315-46c6-879d-b41999a0df57",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "folderId": "1FCPodmeqxEQOYLts_gsmp1OdxJMbPg91",
        "title": "=Piano Editoriale - {{ $now.format('yyyy-MM-dd HH:mm') }}"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        1024,
        144
      ],
      "id": "15117b4e-335f-4be1-886d-7817a305125c",
      "name": "Create a document1",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "029Rvb06F1hKb7Mh",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "=={{ $('Code in JavaScript').item.json.document_text }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        1248,
        144
      ],
      "id": "eb61b91d-20b1-43d0-84e1-f032e1791013",
      "name": "Update a document1",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "029Rvb06F1hKb7Mh",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "temperature": 0.6
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1584,
        1280
      ],
      "id": "24f6458b-ea2d-4505-977d-766e543ea181",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "9NwljPTV1COroy6h",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Genera ESATTAMENTE 3 post per la fase di ENGAGEMENT INIZIALE.\n\nBRAND TONE DA RISPETTARE:\n{{ $json.brand_tone }}\n\nBRIEF DELLA FASE:\n{{ $json.fase_1.testo_completo }}\n\nISTRUZIONI:\n- Crea 3 post diversi e complementari\n- Ogni post deve essere COMPLETO e PUBBLICABILE immediatamente\n- Segui le indicazioni del brief per: format, tone of voice, CTA, hashtag, timing\n- Rispetta i canali indicati nel brief\n- Applica il brand tone in modo coerente\n\nFORMATO OUTPUT RICHIESTO:\n{\n  \"post_1\": {\n    \"titolo\": \"Titolo creativo del post\",\n    \"testo\": \"Testo completo pronto per pubblicazione\",\n    \"hashtag\": \"#Hashtag #Strategici\",\n    \"cta\": \"Call-to-action specifica\",\n    \"canale\": \"Instagram Feed / TikTok / LinkedIn / Blog\",\n    \"timing\": \"Giorno e orario ottimale\"\n  },\n  \"post_2\": { ... stesso formato ... },\n  \"post_3\": { ... stesso formato ... }\n}\n\nGenera SOLO questo JSON, niente altro.\n========================================\nMODALITÃ€ REVISIONE (Se presente):\n========================================\nIterazione corrente: {{ $json.iteration }}\n\nSE ci sono feedback dal revisore qui sotto, IGNORA le istruzioni precedenti che vanno in conflitto e applica le correzioni richieste:\n\nFEEDBACK REVISORE:\n{{ $json.suggerimenti || \"Nessun feedback (primo giro)\" }}\n\nIMPORTANTE: Se ci sono feedback, riscrivi i post correggendo ESATTAMENTE i punti indicati.",
        "options": {
          "systemMessage": "Sei un copywriter esperto specializzato in contenuti per social media.\nIl tuo compito Ã¨ creare post accattivanti per la fase di PRIMO CONTATTO con il pubblico.\nSegui RIGOROSAMENTE il brand tone fornito.\nGenera contenuti concreti, pronti per la pubblicazione.\n\nREGOLE JSON CRITICHE (LEGGI ATTENTAMENTE):\n1. Il JSON DEVE essere su una singola riga (NO newline reali nel JSON)\n2. Usa spazi normali nel testo, NON andare a capo\n3. NON usare **, ##, markdown, emoji problematiche\n4. NON usare virgolette doppie \" all'interno dei testi (usa virgolette singole ')\n5. Esempio CORRETTO: {\"titolo\":\"Test\",\"testo\":\"Prima frase. Seconda frase.\"}\n6. Esempio ERRATO: {\n   \"titolo\": \"Test\n   con newline\"\n}\n\nIMPORTANTE: Rispondi SEMPRE e SOLO con un JSON valido COMPATTO.\nNON aggiungere testo prima o dopo il JSON.\nInizia direttamente con { e termina con }"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1984,
        832
      ],
      "id": "5532b0cf-b6ec-4c9a-ba59-0933d85202cf",
      "name": "Engagement iniziale"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "={{ $json.id }}"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        1184,
        848
      ],
      "id": "fe04ceb8-5c77-4222-b24f-067f7173e6fd",
      "name": "Get a document",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "029Rvb06F1hKb7Mh",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ==========================================\n// PARSER ROBUSTO PER GOOGLE DOCS - FIXED\n// ==========================================\n\n// 1. Recupera il contenuto in modo sicuro\nconst docData = $input.item.json;\nlet docText = '';\n\n// Tentativi a cascata per trovare il testo\nif (docData.text) {\n  docText = docData.text;\n} else if (docData.body && docData.body.content) {\n  // Iterazione profonda per struttura Google Docs\n  for (const section of docData.body.content) {\n    if (section.paragraph && section.paragraph.elements) {\n      for (const element of section.paragraph.elements) {\n        if (element.textRun && element.textRun.content) {\n          docText += element.textRun.content;\n        }\n      }\n    }\n  }\n} else if (docData.content) {\n  docText = docData.content;\n}\n\n// Controllo finale\nif (!docText || docText.length < 10) {\n  throw new Error('âŒ Documento vuoto o illeggibile');\n}\n\nconsole.log('âœ… Documento letto, lunghezza:', docText.length, 'caratteri');\n\n// ==========================================\n// FUNZIONE DI ESTRAZIONE PULITA\n// ==========================================\nfunction extractSection(text, startMarker, endMarker) {\n  if (!text) return '';\n  \n  const startIndex = text.indexOf(startMarker);\n  if (startIndex === -1) {\n    console.warn(`âš ï¸ Sezione \"${startMarker}\" non trovata`);\n    return '';\n  }\n  \n  let contentStart = startIndex + startMarker.length;\n  \n  let endIndex = -1;\n  if (endMarker) {\n    endIndex = text.indexOf(endMarker, contentStart);\n  }\n  \n  if (endIndex === -1) endIndex = text.length;\n  \n  let result = text.substring(contentStart, endIndex).trim();\n  \n  // Rimuovi righe di separazione\n  result = result.replace(/^(=|-)+/gm, '').trim();\n  \n  return result;\n}\n\n// ==========================================\n// ESTRAZIONE SEZIONI\n// ==========================================\n\n// Estrai Brand Tone (tutto tra IDENTITA' DEL BRAND e FASE 1)\nconst brandTone = extractSection(\n  docText, \n  \"IDENTITA' DEL BRAND\", \n  \"FASE 1: ENGAGEMENT INIZIALE\"\n);\n\n// Estrai Fase 1 (tutto tra FASE 1 e FASE 2)\nconst fase1 = extractSection(\n  docText,\n  \"FASE 1: ENGAGEMENT INIZIALE\",\n  \"FASE 2: MANTENERE HYPE\"\n);\n\n// Estrai Fase 2 (tutto tra FASE 2 e FASE 3)\nconst fase2 = extractSection(\n  docText,\n  \"FASE 2: MANTENERE HYPE\",\n  \"FASE 3: PRE-LANCIO\"\n);\n\n// Estrai Fase 3 (tutto dalla FASE 3 fino alla fine)\nconst fase3 = extractSection(\n  docText,\n  \"FASE 3: PRE-LANCIO\",\n  null  // Prende tutto fino alla fine\n);\n\n// Log di debug\nconsole.log('ðŸ“Š Sezioni estratte:');\nconsole.log('   Brand Tone:', brandTone.length, 'caratteri');\nconsole.log('   Fase 1:', fase1.length, 'caratteri');\nconsole.log('   Fase 2:', fase2.length, 'caratteri');\nconsole.log('   Fase 3:', fase3.length, 'caratteri');\n\n// ==========================================\n// VALIDAZIONE\n// ==========================================\nif (!brandTone || brandTone.length < 50) {\n  console.error('âŒ Brand Tone non estratto correttamente');\n}\n\nif (!fase1 || fase1.length < 50) {\n  console.error('âŒ Fase 1 non estratta correttamente');\n}\n\nif (!fase2 || fase2.length < 50) {\n  console.error('âŒ Fase 2 non estratta correttamente');\n}\n\nif (!fase3 || fase3.length < 50) {\n  console.error('âŒ Fase 3 non estratta correttamente');\n}\n\n// ==========================================\n// OUTPUT STRUTTURATO\n// ==========================================\nreturn [{\n  json: {\n    // Testo completo del documento (per riferimento)\n    documento_completo: docText,\n    \n    // Brand Tone\n    brand_tone: brandTone,\n    \n    // Fase 1: Engagement Iniziale\n    fase_1: {\n      nome: \"ENGAGEMENT INIZIALE\",\n      testo_completo: fase1\n    },\n    \n    // Fase 2: Mantenere Hype\n    fase_2: {\n      nome: \"MANTENERE HYPE\",\n      testo_completo: fase2\n    },\n    \n    // Fase 3: Pre-lancio\n    fase_3: {\n      nome: \"PRE-LANCIO\",\n      testo_completo: fase3\n    },\n    \n    // Metadata\n    iteration: 0,\n    estratto_il: new Date().toISOString()\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1456,
        848
      ],
      "id": "2986810f-10b5-44b8-969a-8b16e4a0b9d4",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Genera 3 post per la fase di MANTENIMENTO HYPE.\n\nBRAND TONE:\n{{ $json.brand_tone }}\n\nBRIEF:\n{{ $json.fase_2.testo_completo }}\n\nISTRUZIONI:\n- Crea 3 post diversi che AMPLIFICANO l'interesse\n- Ogni post deve essere DINAMICO e COINVOLGENTE\n- Mantieni alta l'attenzione del pubblico giÃ  ingaggiato\n- Crea un senso di ANTICIPAZIONE e ESCLUSIVITÃ€\n- Segui il brief per format, tone of voice, CTA, hashtag, timing\n- Rispetta il brand tone\n\nRispondi con questo JSON ESATTO:\n\n{\n  \"post_1\": {\n    \"titolo\": \"scrivi qui il titolo\",\n    \"testo\": \"scrivi qui il testo completo\",\n    \"hashtag\": \"#hashtag1 #hashtag2\",\n    \"cta\": \"scrivi la call-to-action\",\n    \"canale\": \"Instagram Reels/TikTok Live/Email\",\n    \"timing\": \"giorno e ora\"\n  },\n  \"post_2\": {\n    \"titolo\": \"...\",\n    \"testo\": \"...\",\n    \"hashtag\": \"...\",\n    \"cta\": \"...\",\n    \"canale\": \"...\",\n    \"timing\": \"...\"\n  },\n  \"post_3\": {\n    \"titolo\": \"...\",\n    \"testo\": \"...\",\n    \"hashtag\": \"...\",\n    \"cta\": \"...\",\n    \"canale\": \"...\",\n    \"timing\": \"...\"\n  }\n}\n\nIMPORTANTE: Restituisci SOLO il JSON, senza altro testo.\n========================================\nMODALITÃ€ REVISIONE (Se presente):\n========================================\nIterazione corrente: {{ $json.iteration }}\n\nSE ci sono feedback dal revisore qui sotto, IGNORA le istruzioni precedenti che vanno in conflitto e applica le correzioni richieste:\n\nFEEDBACK REVISORE:\n{{ $json.suggerimenti || \"Nessun feedback (primo giro)\" }}\n\nIMPORTANTE: Se ci sono feedback, riscrivi i post correggendo ESATTAMENTE i punti indicati.",
        "options": {
          "systemMessage": "Sei un copywriter esperto specializzato in contenuti virali e coinvolgenti.\nIl tuo compito Ã¨ creare post che MANTENGANO L'ENTUSIASMO e l'interesse del pubblico.\nSegui RIGOROSAMENTE il brand tone fornito.\nGenera contenuti dinamici, entusiasmanti e pronti per la pubblicazione.\n\nRispondi SEMPRE e SOLO in formato JSON valido.\nNON aggiungere testo prima o dopo il JSON.\nNON usare markdown.\nInizia direttamente con { e termina con }."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        2000,
        1104
      ],
      "id": "7cff6a88-f176-4136-9046-ed96fe1a35ff",
      "name": "Mantenere hype"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Genera 3 post per la fase di PRE-LANCIO.\n\nBRAND TONE:\n{{ $json.brand_tone }}\n\nBRIEF:\n{{ $json.fase_3.testo_completo }}\n\nISTRUZIONI:\n- Crea 3 post che PREPARANO AL LANCIO\n- Ogni post deve creare un senso di URGENZA AUTENTICA\n- Includi elementi di ESCLUSIVITÃ€ e ANTICIPAZIONE\n- Le CTA devono essere CHIARE e ORIENTATE ALL'AZIONE\n- Bilancia persuasione e autenticitÃ  del brand\n\nRispondi con questo JSON ESATTO:\n\n{\n  \"post_1\": {\n    \"titolo\": \"...\",\n    \"testo\": \"...\",\n    \"hashtag\": \"...\",\n    \"cta\": \"...\",\n    \"canale\": \"Instagram Live/Email/PR/Eventi\",\n    \"timing\": \"...\"\n  },\n  \"post_2\": { ... },\n  \"post_3\": { ... }\n}\n\n========================================\nMODALITÃ€ REVISIONE (Se presente):\n========================================\nIterazione corrente: {{ $json.iteration }}\n\nSE ci sono feedback dal revisore qui sotto, IGNORA le istruzioni precedenti che vanno in conflitto e applica le correzioni richieste:\n\nFEEDBACK REVISORE:\n{{ $json.suggerimenti || \"Nessun feedback (primo giro)\" }}\n\nIMPORTANTE: Se ci sono feedback, riscrivi i post correggendo ESATTAMENTE i punti indicati.\n",
        "options": {
          "systemMessage": "Sei un copywriter esperto specializzato in contenuti di lancio prodotto.\nIl tuo compito Ã¨ creare post che CONVERTONO l'interesse in azione.\nSegui RIGOROSAMENTE il brand tone fornito.\nGenera contenuti persuasivi, urgenti ma autentici.\n\nRispondi SEMPRE e SOLO in formato JSON valido.\nNON aggiungere testo prima o dopo il JSON.\nNON usare markdown.\nInizia direttamente con { e termina con }."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        2000,
        1344
      ],
      "id": "517759c4-67c7-4f0b-8579-5acfd61bf1f1",
      "name": "Pre-lancio"
    },
    {
      "parameters": {
        "numberInputs": 3
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2800,
        752
      ],
      "id": "78d62ed5-b551-42a8-8f23-fbbec39c3b6d",
      "name": "Merge"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// PARSER ROBUSTO per output AI Gemini\n// ========================================\n\nfunction parseAIOutput(rawOutput) {\n  // Caso 1: Ãˆ giÃ  un oggetto\n  if (typeof rawOutput !== 'string') {\n    return rawOutput;\n  }\n  \n  let text = rawOutput;\n  \n  // Rimuovi markdown e backticks\n  text = text.replace(/```json\\s*/gi, '').replace(/```\\s*/g, '');\n  \n  // Trova i limiti del JSON\n  const firstBrace = text.indexOf('{');\n  const lastBrace = text.lastIndexOf('}');\n  \n  if (firstBrace === -1 || lastBrace === -1) {\n    throw new Error('âŒ Nessuna struttura JSON trovata nel testo');\n  }\n  \n  text = text.substring(firstBrace, lastBrace + 1);\n  \n  // PULIZIA CARATTERI PROBLEMATICI\n  text = text\n    // Rimuovi caratteri di controllo invisibili\n    .replace(/[\\u0000-\\u0008\\u000B-\\u000C\\u000E-\\u001F\\u007F-\\u009F]/g, '')\n    // Converti newline/tab in spazi\n    .replace(/\\r\\n/g, ' ')\n    .replace(/\\n/g, ' ')\n    .replace(/\\r/g, ' ')\n    .replace(/\\t/g, ' ')\n    // Normalizza spazi multipli\n    .replace(/\\s+/g, ' ')\n    .trim();\n  \n  // Tentativo di parse\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    // Log per debug\n    const errorMatch = e.message.match(/position (\\d+)/);\n    if (errorMatch) {\n      const pos = parseInt(errorMatch[1]);\n      const start = Math.max(0, pos - 50);\n      const end = Math.min(text.length, pos + 50);\n      const context = text.substring(start, end);\n      console.error('ðŸ”´ Contesto errore:', context);\n      console.error('ðŸ”´ Carattere problematico alla pos', pos, ':', text[pos], '(code:', text.charCodeAt(pos), ')');\n    }\n    console.error('ðŸ”´ JSON completo (primi 1000 char):', text.substring(0, 1000));\n    throw new Error(`âŒ Parse fallito: ${e.message}`);\n  }\n}\n\n// ========================================\n// MAIN EXECUTION\n// ========================================\n\ntry {\n  // Prendi l'output dall'AI Agent\n  const rawOutput = $input.item.json.output || $input.item.json.text || $input.item.json;\n  \n  console.log('ðŸ“¥ Tipo output ricevuto:', typeof rawOutput);\n  \n  // Parse con funzione robusta\n  const parsed = parseAIOutput(rawOutput);\n  \n  // Validazione struttura\n  if (!parsed.post_1 || !parsed.post_2 || !parsed.post_3) {\n    throw new Error('âŒ Struttura JSON invalida: mancano post_1, post_2 o post_3');\n  }\n  \n  console.log('âœ… JSON parsato con successo!');\n  \n  // Estrai il brand_tone dal nodo precedente\n  const brandTone = $('Code in JavaScript1').item.json.brand_tone;\n  \n  // Ritorna dati strutturati per il Merge\n  return [{\n    json: {\n      fase: \"ENGAGEMENT INIZIALE\",\n      \n      // I 3 post della fase 1\n      post_1: {\n        titolo: parsed.post_1.titolo || '',\n        testo: parsed.post_1.testo || '',\n        hashtag: parsed.post_1.hashtag || '',\n        cta: parsed.post_1.cta || '',\n        canale: parsed.post_1.canale || '',\n        timing: parsed.post_1.timing || ''\n      },\n      post_2: {\n        titolo: parsed.post_2.titolo || '',\n        testo: parsed.post_2.testo || '',\n        hashtag: parsed.post_2.hashtag || '',\n        cta: parsed.post_2.cta || '',\n        canale: parsed.post_2.canale || '',\n        timing: parsed.post_2.timing || ''\n      },\n      post_3: {\n        titolo: parsed.post_3.titolo || '',\n        testo: parsed.post_3.testo || '',\n        hashtag: parsed.post_3.hashtag || '',\n        cta: parsed.post_3.cta || '',\n        canale: parsed.post_3.canale || '',\n        timing: parsed.post_3.timing || ''\n      },\n      \n      // Brand tone (necessario per il revisore)\n      brand_tone: brandTone,\n      \n      // Metadati per il loop\n      iteration: 0\n    }\n  }];\n  \n} catch (error) {\n  // Gestione errori: ritorna info di debug invece di bloccare\n  console.error('ðŸ”´ ERRORE:', error.message);\n  \n  return [{\n    json: {\n      error: true,\n      error_message: error.message,\n      fase: \"ENGAGEMENT INIZIALE\",\n      raw_output_type: typeof ($input.item.json.output || $input.item.json.text),\n      raw_output_preview: JSON.stringify($input.item.json).substring(0, 300)\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2304,
        832
      ],
      "id": "de11f0a9-151e-4a24-9d7c-b404e768c15c",
      "name": "Code "
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// PARSER ROBUSTO per output AI Gemini\n// ========================================\n\nfunction parseAIOutput(rawOutput) {\n  // Caso 1: Ãˆ giÃ  un oggetto\n  if (typeof rawOutput !== 'string') {\n    return rawOutput;\n  }\n  \n  let text = rawOutput;\n  \n  // Rimuovi markdown e backticks\n  text = text.replace(/```json\\s*/gi, '').replace(/```\\s*/g, '');\n  \n  // Trova i limiti del JSON\n  const firstBrace = text.indexOf('{');\n  const lastBrace = text.lastIndexOf('}');\n  \n  if (firstBrace === -1 || lastBrace === -1) {\n    throw new Error('âŒ Nessuna struttura JSON trovata nel testo');\n  }\n  \n  text = text.substring(firstBrace, lastBrace + 1);\n  \n  // PULIZIA CARATTERI PROBLEMATICI\n  text = text\n    // Rimuovi caratteri di controllo invisibili\n    .replace(/[\\u0000-\\u0008\\u000B-\\u000C\\u000E-\\u001F\\u007F-\\u009F]/g, '')\n    // Converti newline/tab in spazi\n    .replace(/\\r\\n/g, ' ')\n    .replace(/\\n/g, ' ')\n    .replace(/\\r/g, ' ')\n    .replace(/\\t/g, ' ')\n    // Normalizza spazi multipli\n    .replace(/\\s+/g, ' ')\n    .trim();\n  \n  // Tentativo di parse\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    // Log per debug\n    const errorMatch = e.message.match(/position (\\d+)/);\n    if (errorMatch) {\n      const pos = parseInt(errorMatch[1]);\n      const start = Math.max(0, pos - 50);\n      const end = Math.min(text.length, pos + 50);\n      const context = text.substring(start, end);\n      console.error('ðŸ”´ Contesto errore:', context);\n      console.error('ðŸ”´ Carattere problematico alla pos', pos, ':', text[pos], '(code:', text.charCodeAt(pos), ')');\n    }\n    console.error('ðŸ”´ JSON completo (primi 1000 char):', text.substring(0, 1000));\n    throw new Error(`âŒ Parse fallito: ${e.message}`);\n  }\n}\n\n// ========================================\n// MAIN EXECUTION\n// ========================================\n\ntry {\n  // Prendi l'output dall'AI Agent\n  const rawOutput = $input.item.json.output || $input.item.json.text || $input.item.json;\n  \n  console.log('ðŸ“¥ Tipo output ricevuto:', typeof rawOutput);\n  \n  // Parse con funzione robusta\n  const parsed = parseAIOutput(rawOutput);\n  \n  // Validazione struttura\n  if (!parsed.post_1 || !parsed.post_2 || !parsed.post_3) {\n    throw new Error('âŒ Struttura JSON invalida: mancano post_1, post_2 o post_3');\n  }\n  \n  console.log('âœ… JSON parsato con successo!');\n  \n  // Estrai il brand_tone dal nodo precedente\n  const brandTone = $('Code in JavaScript1').item.json.brand_tone;\n  \n  // Ritorna dati strutturati per il Merge\n  return [{\n    json: {\n      fase: \"MANTENERE HYPE\",  // âœ… CORRETTO per fase 2\n      \n      // I 3 post della fase 2\n      post_1: {\n        titolo: parsed.post_1.titolo || '',\n        testo: parsed.post_1.testo || '',\n        hashtag: parsed.post_1.hashtag || '',\n        cta: parsed.post_1.cta || '',\n        canale: parsed.post_1.canale || '',\n        timing: parsed.post_1.timing || ''\n      },\n      post_2: {\n        titolo: parsed.post_2.titolo || '',\n        testo: parsed.post_2.testo || '',\n        hashtag: parsed.post_2.hashtag || '',\n        cta: parsed.post_2.cta || '',\n        canale: parsed.post_2.canale || '',\n        timing: parsed.post_2.timing || ''\n      },\n      post_3: {\n        titolo: parsed.post_3.titolo || '',\n        testo: parsed.post_3.testo || '',\n        hashtag: parsed.post_3.hashtag || '',\n        cta: parsed.post_3.cta || '',\n        canale: parsed.post_3.canale || '',\n        timing: parsed.post_3.timing || ''\n      },\n      \n      // Brand tone (necessario per il revisore)\n      brand_tone: brandTone,\n      \n      // Metadati per il loop\n      iteration: 0\n    }\n  }];\n  \n} catch (error) {\n  // Gestione errori: ritorna info di debug invece di bloccare\n  console.error('ðŸ”´ ERRORE:', error.message);\n  \n  return [{\n    json: {\n      error: true,\n      error_message: error.message,\n      fase: \"MANTENERE HYPE\",\n      raw_output_type: typeof ($input.item.json.output || $input.item.json.text),\n      raw_output_preview: JSON.stringify($input.item.json).substring(0, 300)\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2384,
        1104
      ],
      "id": "79ab9f9c-fd7e-4bbf-af90-e801c050928f",
      "name": "Code 2"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// PARSER ROBUSTO per output AI Gemini\n// ========================================\n\nfunction parseAIOutput(rawOutput) {\n  // Caso 1: Ãˆ giÃ  un oggetto\n  if (typeof rawOutput !== 'string') {\n    return rawOutput;\n  }\n  \n  let text = rawOutput;\n  \n  // Rimuovi markdown e backticks\n  text = text.replace(/```json\\s*/gi, '').replace(/```\\s*/g, '');\n  \n  // Trova i limiti del JSON\n  const firstBrace = text.indexOf('{');\n  const lastBrace = text.lastIndexOf('}');\n  \n  if (firstBrace === -1 || lastBrace === -1) {\n    throw new Error('âŒ Nessuna struttura JSON trovata nel testo');\n  }\n  \n  text = text.substring(firstBrace, lastBrace + 1);\n  \n  // PULIZIA CARATTERI PROBLEMATICI\n  text = text\n    // Rimuovi caratteri di controllo invisibili\n    .replace(/[\\u0000-\\u0008\\u000B-\\u000C\\u000E-\\u001F\\u007F-\\u009F]/g, '')\n    // Converti newline/tab in spazi\n    .replace(/\\r\\n/g, ' ')\n    .replace(/\\n/g, ' ')\n    .replace(/\\r/g, ' ')\n    .replace(/\\t/g, ' ')\n    // Normalizza spazi multipli\n    .replace(/\\s+/g, ' ')\n    .trim();\n  \n  // Tentativo di parse\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    // Log per debug\n    const errorMatch = e.message.match(/position (\\d+)/);\n    if (errorMatch) {\n      const pos = parseInt(errorMatch[1]);\n      const start = Math.max(0, pos - 50);\n      const end = Math.min(text.length, pos + 50);\n      const context = text.substring(start, end);\n      console.error('ðŸ”´ Contesto errore:', context);\n      console.error('ðŸ”´ Carattere problematico alla pos', pos, ':', text[pos], '(code:', text.charCodeAt(pos), ')');\n    }\n    console.error('ðŸ”´ JSON completo (primi 1000 char):', text.substring(0, 1000));\n    throw new Error(`âŒ Parse fallito: ${e.message}`);\n  }\n}\n\n// ========================================\n// MAIN EXECUTION\n// ========================================\n\ntry {\n  // Prendi l'output dall'AI Agent\n  const rawOutput = $input.item.json.output || $input.item.json.text || $input.item.json;\n  \n  console.log('ðŸ“¥ Tipo output ricevuto:', typeof rawOutput);\n  \n  // Parse con funzione robusta\n  const parsed = parseAIOutput(rawOutput);\n  \n  // Validazione struttura\n  if (!parsed.post_1 || !parsed.post_2 || !parsed.post_3) {\n    throw new Error('âŒ Struttura JSON invalida: mancano post_1, post_2 o post_3');\n  }\n  \n  console.log('âœ… JSON parsato con successo!');\n  \n  // Estrai il brand_tone dal nodo precedente\n  const brandTone = $('Code in JavaScript1').item.json.brand_tone;\n  \n  // Ritorna dati strutturati per il Merge\n  return [{\n    json: {\n      fase: \"PRE-LANCIO\",  // âœ… CORRETTO!\n      \n      // I 3 post della fase 3\n      post_1: {\n        titolo: parsed.post_1.titolo || '',\n        testo: parsed.post_1.testo || '',\n        hashtag: parsed.post_1.hashtag || '',\n        cta: parsed.post_1.cta || '',\n        canale: parsed.post_1.canale || '',\n        timing: parsed.post_1.timing || ''\n      },\n      post_2: {\n        titolo: parsed.post_2.titolo || '',\n        testo: parsed.post_2.testo || '',\n        hashtag: parsed.post_2.hashtag || '',\n        cta: parsed.post_2.cta || '',\n        canale: parsed.post_2.canale || '',\n        timing: parsed.post_2.timing || ''\n      },\n      post_3: {\n        titolo: parsed.post_3.titolo || '',\n        testo: parsed.post_3.testo || '',\n        hashtag: parsed.post_3.hashtag || '',\n        cta: parsed.post_3.cta || '',\n        canale: parsed.post_3.canale || '',\n        timing: parsed.post_3.timing || ''\n      },\n      \n      // Brand tone (necessario per il revisore)\n      brand_tone: brandTone,\n      \n      // Metadati per il loop\n      iteration: 0\n    }\n  }];\n  \n} catch (error) {\n  // Gestione errori: ritorna info di debug invece di bloccare\n  console.error('ðŸ”´ ERRORE:', error.message);\n  \n  return [{\n    json: {\n      error: true,\n      error_message: error.message,\n      fase: \"PRE-LANCIO\",  // âœ… CORRETTO!\n      raw_output_type: typeof ($input.item.json.output || $input.item.json.text),\n      raw_output_preview: JSON.stringify($input.item.json).substring(0, 300)\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2384,
        1344
      ],
      "id": "631a1f0b-3be8-42aa-bf34-eed38ff5fe10",
      "name": "Code 3"
    },
    {
      "parameters": {
        "options": {
          "temperature": 0.2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        3328,
        960
      ],
      "id": "30d71df6-0756-476f-897f-d53a5cb31a06",
      "name": "Google Gemini Chat Model2",
      "credentials": {
        "googlePalmApi": {
          "id": "9NwljPTV1COroy6h",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// UNIFICA TUTTI I POST DAL MERGE\n// ========================================\n\nconst allItems = $input.all();\n\nconsole.log(`ðŸ”¥ Ricevuti ${allItems.length} items dal Merge`);\n\n// Inizializza struttura unificata\nconst unifiedData = {\n  brand_tone: allItems[0].json.brand_tone,\n  iteration: allItems[0].json.iteration || 0,\n  \n  // Contenitori per i post di ogni fase\n  fase_1: { nome: \"ENGAGEMENT INIZIALE\", posts: [] },\n  fase_2: { nome: \"MANTENERE HYPE\", posts: [] },\n  fase_3: { nome: \"PRE-LANCIO\", posts: [] }\n};\n\n// Itera su ogni item del merge e raggruppa i post\nfor (const item of allItems) {\n  const fase = item.json.fase;\n  \n  // Estrai i 3 post dell'item corrente\n  const posts = [\n    {\n      titolo: item.json.post_1?.titolo || 'N/A',\n      testo: item.json.post_1?.testo || 'N/A',\n      hashtag: item.json.post_1?.hashtag || '',\n      cta: item.json.post_1?.cta || '',\n      canale: item.json.post_1?.canale || '',\n      timing: item.json.post_1?.timing || ''\n    },\n    {\n      titolo: item.json.post_2?.titolo || 'N/A',\n      testo: item.json.post_2?.testo || 'N/A',\n      hashtag: item.json.post_2?.hashtag || '',\n      cta: item.json.post_2?.cta || '',\n      canale: item.json.post_2?.canale || '',\n      timing: item.json.post_2?.timing || ''\n    },\n    {\n      titolo: item.json.post_3?.titolo || 'N/A',\n      testo: item.json.post_3?.testo || 'N/A',\n      hashtag: item.json.post_3?.hashtag || '',\n      cta: item.json.post_3?.cta || '',\n      canale: item.json.post_3?.canale || '',\n      timing: item.json.post_3?.timing || ''\n    }\n  ];\n  \n  // Assegna ai bucket corretti in base alla fase\n  if (fase === \"ENGAGEMENT INIZIALE\") {\n    unifiedData.fase_1.posts = posts;\n  } else if (fase === \"MANTENERE HYPE\") {\n    unifiedData.fase_2.posts = posts;\n  } else if (fase === \"PRE-LANCIO\") {\n    unifiedData.fase_3.posts = posts;\n  }\n}\n\n// ========================================\n// CREA TESTO FORMATTATO PER L'AI EVALUATOR\n// ========================================\n\nlet reviewText = `========================================\\n`;\nreviewText += `BRAND TONE DA RISPETTARE:\\n`;\nreviewText += `========================================\\n`;\nreviewText += `${unifiedData.brand_tone}\\n\\n`;\n\n// FASE 1\nreviewText += `========================================\\n`;\nreviewText += `FASE 1: ${unifiedData.fase_1.nome}\\n`;\nreviewText += `========================================\\n\\n`;\nunifiedData.fase_1.posts.forEach((post, i) => {\n  reviewText += `POST ${i+1}: ${post.titolo}\\n`;\n  reviewText += `Testo: ${post.testo}\\n`;\n  reviewText += `Hashtag: ${post.hashtag}\\n`;\n  reviewText += `CTA: ${post.cta}\\n`;\n  reviewText += `Canale: ${post.canale}\\n`;\n  reviewText += `Timing: ${post.timing}\\n\\n`;\n});\n\n// FASE 2\nreviewText += `========================================\\n`;\nreviewText += `FASE 2: ${unifiedData.fase_2.nome}\\n`;\nreviewText += `========================================\\n\\n`;\nunifiedData.fase_2.posts.forEach((post, i) => {\n  reviewText += `POST ${i+1}: ${post.titolo}\\n`;\n  reviewText += `Testo: ${post.testo}\\n`;\n  reviewText += `Hashtag: ${post.hashtag}\\n`;\n  reviewText += `CTA: ${post.cta}\\n`;\n  reviewText += `Canale: ${post.canale}\\n`;\n  reviewText += `Timing: ${post.timing}\\n\\n`;\n});\n\n// FASE 3\nreviewText += `========================================\\n`;\nreviewText += `FASE 3: ${unifiedData.fase_3.nome}\\n`;\nreviewText += `========================================\\n\\n`;\nunifiedData.fase_3.posts.forEach((post, i) => {\n  reviewText += `POST ${i+1}: ${post.titolo}\\n`;\n  reviewText += `Testo: ${post.testo}\\n`;\n  reviewText += `Hashtag: ${post.hashtag}\\n`;\n  reviewText += `CTA: ${post.cta}\\n`;\n  reviewText += `Canale: ${post.canale}\\n`;\n  reviewText += `Timing: ${post.timing}\\n\\n`;\n});\n\n// Log di debug\nconsole.log(`âœ… Post unificati:`);\nconsole.log(`   Fase 1: ${unifiedData.fase_1.posts.length} post`);\nconsole.log(`   Fase 2: ${unifiedData.fase_2.posts.length} post`);\nconsole.log(`   Fase 3: ${unifiedData.fase_3.posts.length} post`);\nconsole.log(`   Lunghezza testo per AI: ${reviewText.length} caratteri`);\n\n// ========================================\n// OUTPUT: UN SOLO ITEM CON TUTTO\n// ========================================\n\nreturn [{\n  json: {\n    // Dati strutturati\n    ...unifiedData,\n    \n    // Testo formattato per l'AI\n    review_text: reviewText,\n    \n    // âœ… AGGIUNGI QUESTI DATI PER IL LOOP (IMPORTANTISSIMO!)\n    _loop_data: {\n      brand_tone: unifiedData.brand_tone,\n      iteration: unifiedData.iteration,\n      \n      // Dati originali dal nodo \"Code in JavaScript1\" per il loop\n      // Li recuperiamo dal primo item che li contiene\n      original_fase_1_brief: allItems[0].json.fase_1?.testo_completo || \n                             $('Code in JavaScript1').item.json.fase_1.testo_completo,\n      original_fase_2_brief: allItems[0].json.fase_2?.testo_completo || \n                             $('Code in JavaScript1').item.json.fase_2.testo_completo,\n      original_fase_3_brief: allItems[0].json.fase_3?.testo_completo || \n                             $('Code in JavaScript1').item.json.fase_3.testo_completo\n    },\n    \n    // Metadati\n    total_posts: 9,\n    timestamp: new Date().toISOString()\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3040,
        768
      ],
      "id": "01fc179c-9c85-4171-a8b6-fb679a4c00b3",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Sei un senior brand auditor CRITICO con 15 anni di esperienza.\n\nIl tuo compito Ã¨ VALUTARE con RIGORE ASSOLUTO se i contenuti rispettano il brand tone.\nNON sei permissivo: se qualcosa non va, devi identificarlo e dare un punteggio basso.\n\n========================================\nCONTENUTI DA VALUTARE:\n========================================\n\n{{ $json.review_text }}\n\n========================================\nCRITERI DI VALUTAZIONE (SII SEVERO):\n========================================\n\n1. COERENZA CON IL BRAND TONE (0-10)\n   Domande da porti:\n   - Il tono di voce Ã¨ ESATTAMENTE quello descritto nel brand tone?\n   - Ogni singola parola riflette la personalitÃ  del brand?\n   - I valori del brand sono EVIDENTI in ogni frase?\n   \n   Punteggi:\n   - 9-10: Perfetta coerenza, impossibile migliorare\n   - 7-8: Buona coerenza, piccoli aggiustamenti\n   - 5-6: Coerenza parziale, diverse frasi da riscrivere\n   - 0-4: Scarsa coerenza, riscrittura necessaria\n\n2. QUALITÃ€ DEI CONTENUTI (0-10)\n   Verifica:\n   - Errori grammaticali? (anche UNO = max punteggio 7)\n   - Frasi generiche o clichÃ©? (es: \"scopri di piÃ¹\", \"non perdere l'occasione\")\n   - Linguaggio poco professionale o troppo formale?\n   - Struttura confusa o poco scorrevole?\n   \n   Punteggi:\n   - 9-10: Contenuto impeccabile, pronto per pubblicazione\n   - 7-8: Buono, ma ci sono 1-2 frasi da migliorare\n   - 5-6: QualitÃ  media, molte frasi da riscrivere\n   - 0-4: QualitÃ  bassa, revisione completa necessaria\n\n3. EFFICACIA DELLE CTA (0-10)\n   Analizza:\n   - Le CTA sono SPECIFICHE o generiche? (\"clicca qui\" = punteggio basso)\n   - Creano urgenza reale o finta?\n   - Sono allineate alla fase del funnel?\n   - Usano un linguaggio persuasivo ma autentico?\n   \n   Esempi di CTA SCARSE (max punteggio 5):\n   - \"Scopri di piÃ¹\"\n   - \"Clicca qui\"\n   - \"Visita il nostro sito\"\n   - \"Non perdere l'occasione\"\n   \n   Esempi di CTA BUONE (punteggio 8+):\n   - \"Prenota il tuo posto nella rivoluzione verde\"\n   - \"Unisciti ai 5.000 urban walker che hanno giÃ  scelto la sostenibilitÃ \"\n   - \"Attiva l'alert lancio: solo 48 ore per l'early access\"\n\n4. ORIGINALITÃ€ E CREATIVITÃ€ (0-10)\n   Domande:\n   - I contenuti sono davvero innovativi o ripetono formule viste mille volte?\n   - Ci sono metafore creative, storytelling coinvolgente?\n   - Si distinguono dalla concorrenza o sono \"piÃ¹ dello stesso\"?\n   - Evitano clichÃ¨ del marketing? (es: \"game changer\", \"next level\", \"rivoluzionario\")\n\n========================================\nREGOLE DI GIUDIZIO SEVERE:\n========================================\n\n- Media >= 8.5 â†’ \"OTTIMO\" (contenuti davvero eccellenti, rari da trovare)\n- Media >= 7.0 â†’ \"BUONO\" (contenuti solidi, piccoli ritocchi)\n- Media < 7.0 â†’ \"DA_MIGLIORARE\" (revisione necessaria)\n\nâš ï¸ IMPORTANTE: \n- NON dare punteggi alti \"per essere gentile\"\n- Se hai QUALSIASI dubbio, abbassa il punteggio\n- Se trovi anche solo 1-2 frasi deboli, il punteggio MAX Ã¨ 7.5\n- Un contenuto \"OTTIMO\" (9-10) deve essere pubblicabile IMMEDIATAMENTE senza modifiche\n\n========================================\nFEEDBACK SPECIFICI (SE PUNTEGGIO < 8.5):\n========================================\n\nPer OGNI problema trovato, fornisci:\n1. DOVE: \"Post X, Fase Y\"\n2. COSA: Cita la frase problematica (max 10 parole)\n3. PERCHÃ‰: Spiega il problema in 1 riga\n4. COME: Fornisci una riscrittura concreta\n\nEsempio CORRETTO di suggerimento:\n\"Post 2, Fase 1: La frase 'Scopri le nostre sneakers' Ã¨ troppo generica e non riflette il tono audace del brand. Riscrivere come: 'Cammina sul futuro: sneakers che rispettano il pianeta senza compromessi sul design urbano' per enfatizzare sostenibilitÃ  + stile (valori core).\"\n\nEsempio SBAGLIATO di suggerimento:\n\"Il post 2 non Ã¨ abbastanza coinvolgente\" (âŒ troppo vago)\n\n========================================\nOUTPUT RICHIESTO (JSON):\n========================================\n\n{\n  \"valutazione\": {\n    \"coerenza_brand\": 7.5,\n    \"qualita_contenuti\": 8.0,\n    \"efficacia_cta\": 6.5,\n    \"originalita\": 7.0,\n    \"media\": 7.25\n  },\n  \"giudizio\": \"BUONO\",\n  \"feedback\": \"I contenuti sono solidi ma presentano CTA generiche e alcune frasi clichÃ©. La fase 1 ha un tono troppo formale rispetto al brand tone giovane e diretto. La fase 3 usa linguaggio persuasivo efficace.\",\n  \"suggerimenti_fase_1\": [\n    \"Post 1: La CTA 'Scopri di piÃ¹' Ã¨ generica. Usare 'Attiva l'alert lancio: sii tra i primi 100' per creare urgenza reale e esclusivitÃ  (allineato al target giovani urbani).\",\n    \"Post 3: Il testo 'Siamo lieti di presentarvi' Ã¨ troppo formale. Riscrivere come 'Vi presentiamo' o 'Ecco' per mantenere il tono giovane e diretto del brand.\"\n  ],\n  \"suggerimenti_fase_2\": [\n    \"Post 2: Rimuovere il clichÃ© 'game changer' e sostituire con un beneficio concreto: 'Riduci del 40% la tua carbon footprint senza rinunciare allo stile street'\"\n  ],\n  \"suggerimenti_fase_3\": []\n}\n\nREGOLE CRITICHE:\n- Se TUTTI i post sono davvero OTTIMI (9+), SOLO ALLORA lascia gli array vuoti: []\n- Altrimenti, DEVI fornire suggerimenti specifici per ogni problema\n- Calcola la media come: (coerenza + qualitÃ  + efficacia + originalitÃ ) / 4\n- Arrotonda a 1 decimale\n- Il campo \"feedback\" deve essere un RIASSUNTO generale (2-3 righe)",
        "options": {
          "systemMessage": "Sei un brand auditor RIGOROSO e CRITICO.\n\nLe tue valutazioni sono SEVERE e OGGETTIVE.\nUn contenuto mediocre riceve 6-7, non 8-9.\nUn contenuto OTTIMO (9-10) Ã¨ RARO e deve essere PERFETTO.\n\nMENTALITÃ€ DA ADOTTARE:\n\"Questo contenuto Ã¨ pubblicabile OGGI senza modifiche?\"\n- SÃŒ â†’ punteggio 9-10\n- Con piccole modifiche â†’ punteggio 7-8\n- Con modifiche sostanziali â†’ punteggio 5-6\n- Riscrittura completa â†’ punteggio 0-4\n\nREGOLE ASSOLUTE:\n1. Rispondi SOLO in formato JSON valido\n2. NON aggiungere testo, markdown o spiegazioni\n3. Inizia direttamente con { e termina con }\n4. Se trovi problemi, DEVI compilare gli array suggerimenti\n5. Array vuoti [] SOLO se punteggio medio >= 8.5\n6. Media = (coerenza + qualitÃ  + efficacia + originalitÃ ) / 4\n7. Arrotonda la media a 1 decimale\n\nNON essere permissivo. Sii il revisore piÃ¹ critico del team."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        3344,
        768
      ],
      "id": "f9ae4d81-36e3-4507-80d6-a820126ab6ba",
      "name": "Revisore"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// PARSE REVISIONE + LOOP CONTROLLER (VERSIONE FIXED)\n// ========================================\n\ntry {\n  // ========================================\n  // STEP 1: PARSE OUTPUT DEL REVISORE\n  // ========================================\n  \n  let revisione;\n  const rawOutput = $input.item.json.output || $input.item.json.text || $input.item.json;\n  \n  console.log('ðŸ” Tipo output ricevuto:', typeof rawOutput);\n  \n  // Caso 1: Ãˆ giÃ  un oggetto pulito\n  if (typeof rawOutput === 'object' && rawOutput.valutazione) {\n    console.log('âœ… Output giÃ  parsato correttamente');\n    revisione = rawOutput;\n  }\n  // Caso 2: Ãˆ una stringa JSON\n  else if (typeof rawOutput === 'string') {\n    console.log('âš ï¸ Output Ã¨ una stringa, tento il parse...');\n    \n    let cleanJson = rawOutput\n      .replace(/```json\\s*/gi, '')\n      .replace(/```\\s*/g, '')\n      .trim();\n    \n    const firstBrace = cleanJson.indexOf('{');\n    const lastBrace = cleanJson.lastIndexOf('}');\n    \n    if (firstBrace !== -1 && lastBrace !== -1) {\n      cleanJson = cleanJson.substring(firstBrace, lastBrace + 1);\n    }\n    \n    try {\n      revisione = JSON.parse(cleanJson);\n      console.log('âœ… Parse riuscito!');\n    } catch (parseError) {\n      throw new Error(`Parse JSON fallito: ${parseError.message}`);\n    }\n  }\n  else {\n    throw new Error(`Formato output non riconosciuto. Tipo: ${typeof rawOutput}`);\n  }\n  \n  // ========================================\n  // STEP 2: VALIDAZIONE STRUTTURA\n  // ========================================\n  \n  if (!revisione.valutazione) {\n    throw new Error('Manca il campo \"valutazione\"');\n  }\n  \n  if (!revisione.valutazione.coerenza_brand || \n      !revisione.valutazione.qualita_contenuti || \n      !revisione.valutazione.efficacia_cta || \n      !revisione.valutazione.originalita) {\n    throw new Error('Campi \"valutazione\" incompleti');\n  }\n  \n  // ========================================\n  // STEP 3: LOG REVISIONE\n  // ========================================\n  \n  console.log('ðŸ“Š REVISIONE RICEVUTA:');\n  console.log(`   Coerenza Brand: ${revisione.valutazione.coerenza_brand}/10`);\n  console.log(`   QualitÃ  Contenuti: ${revisione.valutazione.qualita_contenuti}/10`);\n  console.log(`   Efficacia CTA: ${revisione.valutazione.efficacia_cta}/10`);\n  console.log(`   OriginalitÃ : ${revisione.valutazione.originalita}/10`);\n  console.log(`   ðŸ“ˆ MEDIA: ${revisione.valutazione.media}/10`);\n  console.log(`   ðŸ† GIUDIZIO: ${revisione.giudizio}`);\n  \n  // ========================================\n  // STEP 4: RECUPERA ITERATION E DATI\n  // ========================================\n  \n  const inputFromRevisore = $input.first().json;\n  const currentIteration = inputFromRevisore.iteration || 0;\n  const maxIterations = 2;\n  \n  console.log(`ðŸ”¢ Iteration corrente: ${currentIteration}`);\n  \n  // ========================================\n  // STEP 5: LOGICA DI DECISIONE\n  // ========================================\n  \n  const media = revisione.valutazione.media;\n  const giudizio = revisione.giudizio;\n  \n  const isQualityGood = (giudizio === \"OTTIMO\" || giudizio === \"BUONO\" || media >= 7.0);\n  const isMaxIterationsReached = (currentIteration >= maxIterations);\n  \n  const shouldStop = isQualityGood || isMaxIterationsReached;\n  \n  console.log('\\nðŸš¦ DECISIONE LOOP:');\n  console.log(`   Iterazione: ${currentIteration + 1}/${maxIterations + 1}`);\n  console.log(`   QualitÃ  OK? ${isQualityGood ? 'âœ…' : 'âŒ'}`);\n  console.log(`   Max iter? ${isMaxIterationsReached ? 'ðŸ›‘' : 'â³'}`);\n  console.log(`   ðŸ‘‰ ${shouldStop ? 'FERMA âœ…' : 'CONTINUA ðŸ”„'}`);\n  \n  // ========================================\n  // STEP 6: PREPARA OUTPUT\n  // ========================================\n  \n  if (shouldStop) {\n    // âœ… RECUPERA I POST DAL NODO \"Code in JavaScript2\"\n    let postsData;\n    \n    try {\n      postsData = $('Code in JavaScript2').first().json;\n      \n      console.log('âœ… Dati recuperati da Code in JavaScript2:');\n      console.log(`   - fase_1.posts: ${postsData.fase_1?.posts?.length || 0}`);\n      console.log(`   - fase_2.posts: ${postsData.fase_2?.posts?.length || 0}`);\n      console.log(`   - fase_3.posts: ${postsData.fase_3?.posts?.length || 0}`);\n    } catch (error) {\n      console.error('âš ï¸ Impossibile recuperare dati da Code in JavaScript2:', error.message);\n      \n      // Fallback: usa dati fittizi\n      postsData = {\n        fase_1: { nome: \"ENGAGEMENT INIZIALE\", posts: [] },\n        fase_2: { nome: \"MANTENERE HYPE\", posts: [] },\n        fase_3: { nome: \"PRE-LANCIO\", posts: [] },\n        brand_tone: inputFromRevisore.brand_tone || ''\n      };\n    }\n    \n    return [{\n      json: {\n        should_continue: false,\n        \n        // Dati della revisione\n        revisione: revisione,\n        punteggio_medio: media,\n        giudizio: giudizio,\n        iteration_finale: currentIteration,\n        \n        // âœ… USA I POST DAL NODO \"Code in JavaScript2\"\n        fase_1: postsData.fase_1 || { nome: \"ENGAGEMENT INIZIALE\", posts: [] },\n        fase_2: postsData.fase_2 || { nome: \"MANTENERE HYPE\", posts: [] },\n        fase_3: postsData.fase_3 || { nome: \"PRE-LANCIO\", posts: [] },\n        \n        brand_tone: postsData.brand_tone || inputFromRevisore.brand_tone || '',\n        \n        completed_at: new Date().toISOString()\n      }\n    }];\n    \n  } else {\n    // ========================================\n    // LOOP CONTINUA â†’ RECUPERA DATI ORIGINALI\n    // ========================================\n    \n    console.log('ðŸ”„ Loop continua - Preparazione per nuova iterazione...');\n    \n    // âœ… RECUPERA I BRIEF ORIGINALI DAL NODO \"Code in JavaScript2\"\n    // che li ha salvati in _loop_data\n    let originalBriefs;\n    \n    try {\n      const loopData = $('Code in JavaScript2').first().json._loop_data;\n      \n      if (!loopData) {\n        throw new Error('_loop_data non trovato in Code in JavaScript2');\n      }\n      \n      originalBriefs = {\n        fase_1: loopData.original_fase_1_brief || '',\n        fase_2: loopData.original_fase_2_brief || '',\n        fase_3: loopData.original_fase_3_brief || ''\n      };\n      \n      console.log('âœ… Brief originali recuperati da _loop_data');\n      \n    } catch (error) {\n      console.error('âš ï¸ Errore recupero brief originali:', error.message);\n      \n      // Fallback: prova a recuperare da Code in JavaScript1\n      try {\n        const codeJS1Data = $('Code in JavaScript1').first().json;\n        \n        originalBriefs = {\n          fase_1: codeJS1Data.fase_1?.testo_completo || '',\n          fase_2: codeJS1Data.fase_2?.testo_completo || '',\n          fase_3: codeJS1Data.fase_3?.testo_completo || ''\n        };\n        \n        console.log('âœ… Brief recuperati da Code in JavaScript1 (fallback)');\n        \n      } catch (fallbackError) {\n        console.error('âŒ Fallback fallito:', fallbackError.message);\n        \n        // Ultimo fallback: usa valori vuoti\n        originalBriefs = {\n          fase_1: 'Brief non disponibile',\n          fase_2: 'Brief non disponibile',\n          fase_3: 'Brief non disponibile'\n        };\n      }\n    }\n    \n    // ========================================\n    // PREPARA DATI PER LA PROSSIMA ITERAZIONE\n    // ========================================\n    \n    return [{\n      json: {\n        should_continue: true,\n        iteration: currentIteration + 1,\n        max_iterations: maxIterations,\n        brand_tone: inputFromRevisore.brand_tone,\n        \n        fase_1: {\n          nome: \"ENGAGEMENT INIZIALE\",\n          testo_completo: originalBriefs.fase_1,\n          suggerimenti: revisione.suggerimenti_fase_1 || [],\n          iteration: currentIteration + 1,\n          max_iterations: maxIterations\n        },\n        fase_2: {\n          nome: \"MANTENERE HYPE\",\n          testo_completo: originalBriefs.fase_2,\n          suggerimenti: revisione.suggerimenti_fase_2 || [],\n          iteration: currentIteration + 1,\n          max_iterations: maxIterations\n        },\n        fase_3: {\n          nome: \"PRE-LANCIO\",\n          testo_completo: originalBriefs.fase_3,\n          suggerimenti: revisione.suggerimenti_fase_3 || [],\n          iteration: currentIteration + 1,\n          max_iterations: maxIterations\n        },\n        \n        punteggio_precedente: media,\n        giudizio_precedente: giudizio,\n        feedback: revisione.feedback || ''\n      }\n    }];\n  }\n  \n} catch (error) {\n  console.error('ðŸ”´ ERRORE CRITICO:', error.message);\n  console.error('Stack:', error.stack);\n  \n  // Fallback sicuro\n  return [{\n    json: {\n      should_continue: false,\n      error: true,\n      error_message: error.message,\n      iteration: 999,\n      \n      fase_1: { nome: \"ENGAGEMENT INIZIALE\", posts: [] },\n      fase_2: { nome: \"MANTENERE HYPE\", posts: [] },\n      fase_3: { nome: \"PRE-LANCIO\", posts: [] },\n      \n      user_message: `Errore: ${error.message}`\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3680,
        768
      ],
      "id": "a56b9e97-3e07-4227-9d71-6089f0db85dd",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e8fd6414-c04d-4e63-ba13-69d075d1fd6a",
              "leftValue": "={{ $json.should_continue }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3808,
        528
      ],
      "id": "5b17c1b7-aec8-48f9-a9bb-8f63c5fcdd72",
      "name": "If"
    },
    {
      "parameters": {
        "jsCode": "// ========================================\n// FORMATTA TUTTI I POST PER GOOGLE DOCS (VERSIONE ROBUSTA)\n// ========================================\n\nconst data = $input.item.json;\n\nconsole.log('ðŸ“„ Formattazione documento finale...');\nconsole.log('ðŸ” Debug - Struttura dati ricevuta:');\nconsole.log('   - fase_1:', data.fase_1 ? 'presente' : 'MANCANTE');\nconsole.log('   - fase_2:', data.fase_2 ? 'presente' : 'MANCANTE');\nconsole.log('   - fase_3:', data.fase_3 ? 'presente' : 'MANCANTE');\n\n// ========================================\n// VALIDAZIONE E NORMALIZZAZIONE DATI\n// ========================================\n\n// Funzione per garantire che ogni fase abbia la struttura corretta\nfunction normalizeFase(fase, nomeFase) {\n  if (!fase) {\n    console.warn(`âš ï¸ Fase ${nomeFase} mancante, creo struttura vuota`);\n    return { nome: nomeFase, posts: [] };\n  }\n  \n  // Se la fase non ha posts, aggiungi array vuoto\n  if (!fase.posts || !Array.isArray(fase.posts)) {\n    console.warn(`âš ï¸ Fase ${nomeFase} non ha posts, aggiungo array vuoto`);\n    return { \n      nome: fase.nome || nomeFase, \n      posts: [] \n    };\n  }\n  \n  return fase;\n}\n\n// Normalizza tutte le fasi\nconst fase_1 = normalizeFase(data.fase_1, \"ENGAGEMENT INIZIALE\");\nconst fase_2 = normalizeFase(data.fase_2, \"MANTENERE HYPE\");\nconst fase_3 = normalizeFase(data.fase_3, \"PRE-LANCIO\");\n\nconsole.log('âœ… Fasi normalizzate:');\nconsole.log(`   - Fase 1: ${fase_1.posts.length} post`);\nconsole.log(`   - Fase 2: ${fase_2.posts.length} post`);\nconsole.log(`   - Fase 3: ${fase_3.posts.length} post`);\n\n// ========================================\n// CREA DOCUMENTO FORMATTATO\n// ========================================\n\nlet docText = `========================================\\n`;\ndocText += `CONTENUTI FINALI - PIANO EDITORIALE\\n`;\ndocText += `SNEAKERS SOSTENIBILI\\n`;\ndocText += `========================================\\n\\n`;\n\ndocText += `ðŸ“… Generato il: ${new Date().toLocaleDateString('it-IT', { \n  day: '2-digit', \n  month: 'long', \n  year: 'numeric',\n  hour: '2-digit',\n  minute: '2-digit'\n})}\\n`;\ndocText += `ðŸ“Š Punteggio QualitÃ : ${data.punteggio_medio || 'N/A'}/10\\n`;\ndocText += `ðŸ† Giudizio Finale: ${data.giudizio || 'N/A'}\\n`;\ndocText += `ðŸ”„ Iterazioni Effettuate: ${(data.iteration_finale || 0) + 1}\\n\\n`;\n\n// ========================================\n// REPORT REVISIONE\n// ========================================\nif (data.revisione && data.revisione.feedback) {\n  docText += `\\n${'='.repeat(60)}\\n`;\n  docText += `REPORT REVISIONE\\n`;\n  docText += `${'='.repeat(60)}\\n\\n`;\n  \n  docText += `ðŸ“‹ Feedback Generale:\\n`;\n  docText += `${data.revisione.feedback}\\n\\n`;\n  \n  docText += `ðŸ“Š Dettaglio Punteggi:\\n`;\n  docText += `   â€¢ Coerenza Brand: ${data.revisione.valutazione.coerenza_brand}/10\\n`;\n  docText += `   â€¢ QualitÃ  Contenuti: ${data.revisione.valutazione.qualita_contenuti}/10\\n`;\n  docText += `   â€¢ Efficacia CTA: ${data.revisione.valutazione.efficacia_cta}/10\\n`;\n  docText += `   â€¢ OriginalitÃ : ${data.revisione.valutazione.originalita}/10\\n`;\n  docText += `   â€¢ Media Finale: ${data.revisione.valutazione.media}/10\\n\\n`;\n  \n  // Suggerimenti (gestisce sia array di stringhe che array di oggetti)\n  const suggerimenti = [\n    ...(data.revisione.suggerimenti_fase_1 || []),\n    ...(data.revisione.suggerimenti_fase_2 || []),\n    ...(data.revisione.suggerimenti_fase_3 || [])\n  ];\n  \n  if (suggerimenti.length > 0) {\n    docText += `ðŸ’¡ Suggerimenti di Miglioramento:\\n`;\n    suggerimenti.forEach((sugg, i) => {\n      if (typeof sugg === 'string') {\n        docText += `   ${i + 1}. ${sugg}\\n`;\n      } else if (sugg.DOVE && sugg.COME) {\n        docText += `   ${i + 1}. ${sugg.DOVE}: ${sugg.COME}\\n`;\n      } else if (sugg.DOVE) {\n        docText += `   ${i + 1}. ${sugg.DOVE}: ${sugg.PERCHÃ‰ || 'Da migliorare'}\\n`;\n      }\n    });\n    docText += `\\n`;\n  }\n}\n\n// ========================================\n// FUNZIONE HELPER PER FORMATTARE POST\n// ========================================\nfunction formatPosts(posts, faseNome) {\n  if (!posts || posts.length === 0) {\n    return `âš ï¸ Nessun post disponibile per questa fase.\\n\\n`;\n  }\n  \n  let text = '';\n  posts.forEach((post, i) => {\n    text += `POST ${i + 1}: ${post.titolo || 'Senza titolo'}\\n`;\n    text += `${'-'.repeat(50)}\\n\\n`;\n    text += `ðŸ“± CANALE: ${post.canale || 'N/A'}\\n`;\n    text += `â° TIMING: ${post.timing || 'N/A'}\\n\\n`;\n    text += `ðŸ“ TESTO:\\n${post.testo || 'Nessun testo disponibile'}\\n\\n`;\n    text += `#ï¸âƒ£ HASHTAG:\\n${post.hashtag || 'Nessun hashtag'}\\n\\n`;\n    text += `ðŸŽ¯ CALL-TO-ACTION:\\n${post.cta || 'Nessuna CTA'}\\n\\n`;\n    text += `${'Â·'.repeat(50)}\\n\\n`;\n  });\n  \n  return text;\n}\n\n// ========================================\n// FASE 1: ENGAGEMENT INIZIALE\n// ========================================\ndocText += `\\n${'='.repeat(60)}\\n`;\ndocText += `FASE 1: ${fase_1.nome}\\n`;\ndocText += `${'='.repeat(60)}\\n\\n`;\ndocText += formatPosts(fase_1.posts, fase_1.nome);\n\n// ========================================\n// FASE 2: MANTENERE HYPE\n// ========================================\ndocText += `\\n${'='.repeat(60)}\\n`;\ndocText += `FASE 2: ${fase_2.nome}\\n`;\ndocText += `${'='.repeat(60)}\\n\\n`;\ndocText += formatPosts(fase_2.posts, fase_2.nome);\n\n// ========================================\n// FASE 3: PRE-LANCIO\n// ========================================\ndocText += `\\n${'='.repeat(60)}\\n`;\ndocText += `FASE 3: ${fase_3.nome}\\n`;\ndocText += `${'='.repeat(60)}\\n\\n`;\ndocText += formatPosts(fase_3.posts, fase_3.nome);\n\n// ========================================\n// FOOTER\n// ========================================\ndocText += `\\n${'='.repeat(60)}\\n`;\ndocText += `Fine del Piano Editoriale\\n`;\ndocText += `Totale Post Generati: ${fase_1.posts.length + fase_2.posts.length + fase_3.posts.length}\\n`;\ndocText += `Documento generato automaticamente dal workflow n8n\\n`;\ndocText += `${'='.repeat(60)}\\n`;\n\nconsole.log(`âœ… Documento formattato: ${docText.length} caratteri`);\nconsole.log(`   Total posts: ${fase_1.posts.length + fase_2.posts.length + fase_3.posts.length}`);\n\n// ========================================\n// OUTPUT\n// ========================================\nreturn [{\n  json: {\n    document_text: docText,\n    metadata: {\n      total_posts: fase_1.posts.length + fase_2.posts.length + fase_3.posts.length,\n      final_score: data.punteggio_medio || 0,\n      giudizio: data.giudizio || 'N/A',\n      iterations: (data.iteration_finale || 0) + 1,\n      timestamp: data.completed_at || new Date().toISOString()\n    }\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4288,
        896
      ],
      "id": "8a58ad79-8b8a-4e00-820d-9f54f89e61ab",
      "name": "Formattare per docs"
    },
    {
      "parameters": {
        "folderId": "1FCPodmeqxEQOYLts_gsmp1OdxJMbPg91",
        "title": "=Revisione Finale"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        4496,
        896
      ],
      "id": "2f3b369c-1d6a-4691-a31e-0ae2ed2e72f3",
      "name": "Create a document",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "029Rvb06F1hKb7Mh",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "={{ $('Formattare per docs').item.json.document_text }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        4704,
        896
      ],
      "id": "39a38351-1d66-491b-8a1a-c40913504f36",
      "name": "Update a document",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "029Rvb06F1hKb7Mh",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1728,
        832
      ],
      "id": "2a343344-7a4f-44e4-87e5-50e9e7b3a242",
      "name": "Merge1"
    }
  ],
  "pinData": {
    "Code in JavaScript3": [
      {
        "json": {
          "should_continue": false,
          "revisione": {
            "valutazione": {
              "coerenza_brand": 8.6,
              "qualita_contenuti": 7.2,
              "efficacia_cta": 8.4,
              "originalita": 5.8,
              "media": 7.5
            },
            "giudizio": "BUONO",
            "feedback": "I contenuti mostrano una buona coerenza con un tono che evolve da coinvolgente a urgente, e le CTA sono generalmente efficaci, specialmente nelle fasi avanzate. Tuttavia, la qualitÃ  e l'originalitÃ  sono significativamente compromesse dall'uso eccessivo di clichÃ© e frasi generiche, che rendono i testi meno distintivi e d'impatto.",
            "suggerimenti_fase_1": [
              {
                "DOVE": "Post 1, Fase 1",
                "COSA": "La frase 'strategia segreta' Ã¨ un clichÃ©",
                "PERCHÃ‰": "Ãˆ un'espressione comune che non aggiunge freschezza al messaggio.",
                "COME": "Riscrivere come: 'Qual Ã¨ il tuo approccio vincente per trasformare il lunedÃ¬ in un trampolino di lancio?' per un linguaggio piÃ¹ dinamico e meno abusato."
              },
              {
                "DOVE": "Post 3, Fase 1",
                "COSA": "La frase 'Entrambi gli approcci hanno i loro pro e contro' Ã¨ generica",
                "PERCHÃ‰": "Ãˆ una constatazione ovvia che non stimola la riflessione o l'engagement.",
                "COME": "Riscrivere come: 'Ogni scelta ha la sua forza. Quale ti guida meglio?' per un tono piÃ¹ diretto e incisivo."
              }
            ],
            "suggerimenti_fase_2": [
              {
                "DOVE": "Post 1, Fase 2",
                "COSA": "L'espressione 'cambierÃ  le regole del gioco' Ã¨ un clichÃ©",
                "PERCHÃ‰": "Ãˆ un'affermazione abusata nel marketing che riduce l'originalitÃ  e l'impatto percepito.",
                "COME": "Riscrivere come: 'Siete pronti a scoprire un nuovo paradigma?' per un linguaggio piÃ¹ sofisticato e distintivo."
              },
              {
                "DOVE": "Post 3, Fase 2",
                "COSA": "La frase 'opportunitÃ  unica' Ã¨ generica",
                "PERCHÃ‰": "Non rafforza l'esclusivitÃ  in modo memorabile, essendo un'espressione molto comune.",
                "COME": "Riscrivere come: 'Stiamo per aprire le porte a un'esperienza senza precedenti.' per un messaggio piÃ¹ forte e originale."
              }
            ],
            "suggerimenti_fase_3": [
              {
                "DOVE": "Post 1, Fase 3",
                "COSA": "L'espressione 'cosa bolle in pentola' Ã¨ troppo informale",
                "PERCHÃ‰": "Contrasta con il tono di 'rivoluzione' e 'ridefinizione' che il post intende comunicare.",
                "COME": "Riscrivere come: 'Non perdere l'opportunitÃ  di scoprire le innovazioni che abbiamo in serbo.' per mantenere un tono piÃ¹ autorevole e allineato."
              },
              {
                "DOVE": "Post 2, Fase 3",
                "COSA": "La frase 'cambiare le regole del gioco' Ã¨ un clichÃ©",
                "PERCHÃ‰": "Indebolisce il messaggio di innovazione autentica e rende il testo meno credibile.",
                "COME": "Riscrivere come: 'un'immersione profonda in ciÃ² che sta per ridefinire il settore.' per maggiore specificitÃ  e originalitÃ ."
              },
              {
                "DOVE": "Post 3, Fase 3",
                "COSA": "L'espressione 'offerte irripetibili' Ã¨ un clichÃ©",
                "PERCHÃ‰": "Ãˆ una frase generica che non valorizza adeguatamente i bonus e le offerte esclusive.",
                "COME": "Riscrivere come: 'bonus e vantaggi esclusivi pensati solo per i primi.' per un linguaggio piÃ¹ concreto e persuasivo."
              }
            ]
          },
          "punteggio_medio": 7.5,
          "giudizio": "BUONO",
          "iteration_finale": 0,
          "fase_1": {
            "nome": "ENGAGEMENT INIZIALE",
            "posts": [
              {
                "titolo": "La sfida del lunedÃ¬ mattina?",
                "testo": "Tutti abbiamo quel momento in cui ci sentiamo bloccati o cerchiamo l'ispirazione giusta per iniziare la settimana. Qual Ã¨ la tua strategia segreta per superare gli ostacoli e dare il via alla giornata con la giusta energia? Condividi il tuo trucco del mestiere!",
                "hashtag": "#InizioSettimana #Motivazione #ProduttivitÃ  #ConsigliUtili #Community",
                "cta": "Raccontaci la tua nei commenti!",
                "canale": "Instagram Feed",
                "timing": "LunedÃ¬ mattina, 9:00"
              },
              {
                "titolo": "E se ci fosse un modo piÃ¹ semplice?",
                "testo": "Ti sei mai chiesto se esista una strada meno complessa per raggiungere i tuoi obiettivi? Spesso la soluzione Ã¨ a portata di mano, basta cambiare prospettiva. Qual Ã¨ l'ostacolo che ti sembra insormontabile in questo momento? Forse insieme possiamo trovare una nuova angolazione.",
                "hashtag": "#NuoveProspettive #Innovazione #Soluzioni #Crescita #PensieroLaterale",
                "cta": "Qual Ã¨ la tua sfida attuale?",
                "canale": "LinkedIn",
                "timing": "MercoledÃ¬ pomeriggio, 14:30"
              },
              {
                "titolo": "Scelta rapida: Organizzazione o SpontaneitÃ ?",
                "testo": "Nel lavoro o nella vita, preferisci pianificare ogni dettaglio o lasciarti guidare dall'istinto del momento? Entrambi gli approcci hanno i loro pro e contro. Vota nei commenti con 'Organizzazione' o 'SpontaneitÃ ' e dicci perchÃ©!",
                "hashtag": "#StileDiVita #LavoroSmart #Decisioni #Equilibrio #Opinioni",
                "cta": "Vota e commenta!",
                "canale": "Instagram Feed",
                "timing": "GiovedÃ¬ sera, 18:00"
              }
            ]
          },
          "fase_2": {
            "nome": "MANTENERE HYPE",
            "posts": [
              {
                "titolo": "Il Futuro Ãˆ PiÃ¹ Vicino Di Quanto Pensi... ðŸ¤«",
                "testo": "Siete pronti a scoprire ciÃ² che cambierÃ  le regole del gioco? Abbiamo lavorato instancabilmente per creare qualcosa di rivoluzionario, e l'attesa Ã¨ quasi finita. Preparatevi a un'esperienza che supererÃ  ogni vostra aspettativa. Il conto alla rovescia Ã¨ iniziato! âœ¨",
                "hashtag": "#RivoluzioneImminente #GameChanger #StayTuned #NuoveVibrazioni",
                "cta": "Attiva le notifiche per non perderti nulla!",
                "canale": "Instagram Reels",
                "timing": "MartedÃ¬, ore 18:00"
              },
              {
                "titolo": "Cosa Vi Aspettate Dal Prossimo Livello? ðŸ¤”",
                "testo": "Abbiamo un'idea ben chiara di come stiamo per stupirvi, ma siamo curiosi: qual Ã¨ la vostra previsione piÃ¹ audace? La nostra community Ã¨ il cuore di tutto, e il vostro entusiasmo ci spinge a superare ogni limite. Diteci nei commenti cosa vi piacerebbe vedere! ðŸ‘‡",
                "hashtag": "#HypeTrain #CommunityPower #FuturoAdesso #Innovazione",
                "cta": "Condividi la tua visione!",
                "canale": "Facebook/Instagram Post",
                "timing": "GiovedÃ¬, ore 12:00"
              },
              {
                "titolo": "L'EsclusivitÃ  Chiama: Rispondi? ðŸ“ž",
                "testo": "Non tutti avranno la possibilitÃ  di essere tra i primi. Stiamo per aprire le porte a un'opportunitÃ  unica, riservata a chi Ã¨ pronto a cogliere il futuro al volo. Le liste si stanno riempiendo velocemente. Non rimandare, il tuo posto nel futuro ti aspetta. ðŸš€",
                "hashtag": "#EarlyBird #NonPerderlo #AccessoEsclusivo #Pionieri",
                "cta": "Iscriviti alla lista d'attesa VIP ora!",
                "canale": "Email/Landing Page CTA",
                "timing": "LunedÃ¬, ore 10:00"
              }
            ]
          },
          "fase_3": {
            "nome": "PRE-LANCIO",
            "posts": [
              {
                "titolo": "Il Futuro Sta Arrivando. E Non SarÃ  Come Te Lo Aspetti.",
                "testo": "Stanco delle solite promesse? Anche noi. Abbiamo lavorato in silenzio, spingendoci oltre ogni limite per creare qualcosa che non cambierÃ  solo il tuo modo di [settore/azione], ma lo ridefinirÃ  completamente. Non Ã¨ un aggiornamento, non Ã¨ un'evoluzione. Ãˆ una rivoluzione. E tu potresti essere tra i primi a viverla. Non perdere l'opportunitÃ  di scoprire cosa bolle in pentola prima di tutti. Il tempo stringe, e le novitÃ  sono davvero... inaspettate. Sii pronto a ridefinire le tue aspettative.",
                "hashtag": "#RivoluzioneImminente #FuturoOra #Anticipazione #NonÃˆIlSolito",
                "cta": "Iscriviti alla nostra lista VIP per ricevere aggiornamenti esclusivi prima del lancio!",
                "canale": "Email/Landing Page",
                "timing": "3-4 settimane prima del lancio"
              },
              {
                "titolo": "Accesso Esclusivo: La Tua OpportunitÃ  di Essere Avanti.",
                "testo": "La rivoluzione di cui ti abbiamo parlato si sta avvicinando. Ma prima che il mondo intero la scopra, vogliamo offrire un'opportunitÃ  unica a chi crede nell'innovazione autentica. Abbiamo riservato un numero limitato di posti per un'anteprima esclusiva, un'immersione profonda in ciÃ² che sta per cambiare le regole del gioco. Non Ã¨ solo un'anteprima, Ã¨ un invito a far parte del nostro cerchio piÃ¹ ristretto. Questa Ã¨ la tua occasione per toccare con mano il futuro e influenzarne la direzione, prima che sia troppo tardi. Le disponibilitÃ  sono contate, e l'interesse Ã¨ altissimo. Non rimandare, potresti perdere l'opportunitÃ  di una vita.",
                "hashtag": "#AccessoEsclusivo #EarlyAdopter #InnovazioneAutentica #PostiLimitati",
                "cta": "Richiedi ora il tuo posto per l'anteprima esclusiva e non perdere questa chance!",
                "canale": "Instagram Stories/Email/Landing Page",
                "timing": "2-3 settimane prima del lancio"
              },
              {
                "titolo": "Ultima Chiamata: Il Conto Alla Rovescia Ãˆ Iniziato.",
                "testo": "Mancano pochi giorni. La data di lancio si avvicina inesorabilmente e l'attesa Ã¨ palpabile. Se non ti sei ancora assicurato il tuo posto nella lista prioritaria per il lancio di [Nome Prodotto/Soluzione], questa Ã¨ la tua ULTIMA occasione. Non stiamo solo lanciando un prodotto; stiamo inaugurando una nuova era per [settore/beneficio]. Chi sarÃ  nella lista prioritaria riceverÃ  non solo l'accesso anticipato, ma anche bonus e offerte irripetibili pensate solo per i primi. Non lasciare che questa opportunitÃ  ti sfugga. Il tempo Ã¨ quasi scaduto. Agisci ora o potresti rimpiangerlo.",
                "hashtag": "#ContoAllaRovescia #UltimaChance #LancioImminente #NonPerderlo",
                "cta": "Iscriviti ora alla lista prioritaria e sii tra i primi a beneficiare della rivoluzione!",
                "canale": "Social Media (Post/Ads)/Email",
                "timing": "1 settimana prima del lancio"
              }
            ]
          },
          "brand_tone": "",
          "completed_at": "2025-12-03T00:56:46.826Z"
        }
      }
    ],
    "Code in JavaScript2": [
      {
        "json": {
          "brand_tone": "",
          "iteration": 0,
          "fase_1": {
            "nome": "ENGAGEMENT INIZIALE",
            "posts": [
              {
                "titolo": "La sfida del lunedÃ¬ mattina?",
                "testo": "Tutti abbiamo quel momento in cui ci sentiamo bloccati o cerchiamo l'ispirazione giusta per iniziare la settimana. Qual Ã¨ la tua strategia segreta per superare gli ostacoli e dare il via alla giornata con la giusta energia? Condividi il tuo trucco del mestiere!",
                "hashtag": "#InizioSettimana #Motivazione #ProduttivitÃ  #ConsigliUtili #Community",
                "cta": "Raccontaci la tua nei commenti!",
                "canale": "Instagram Feed",
                "timing": "LunedÃ¬ mattina, 9:00"
              },
              {
                "titolo": "E se ci fosse un modo piÃ¹ semplice?",
                "testo": "Ti sei mai chiesto se esista una strada meno complessa per raggiungere i tuoi obiettivi? Spesso la soluzione Ã¨ a portata di mano, basta cambiare prospettiva. Qual Ã¨ l'ostacolo che ti sembra insormontabile in questo momento? Forse insieme possiamo trovare una nuova angolazione.",
                "hashtag": "#NuoveProspettive #Innovazione #Soluzioni #Crescita #PensieroLaterale",
                "cta": "Qual Ã¨ la tua sfida attuale?",
                "canale": "LinkedIn",
                "timing": "MercoledÃ¬ pomeriggio, 14:30"
              },
              {
                "titolo": "Scelta rapida: Organizzazione o SpontaneitÃ ?",
                "testo": "Nel lavoro o nella vita, preferisci pianificare ogni dettaglio o lasciarti guidare dall'istinto del momento? Entrambi gli approcci hanno i loro pro e contro. Vota nei commenti con 'Organizzazione' o 'SpontaneitÃ ' e dicci perchÃ©!",
                "hashtag": "#StileDiVita #LavoroSmart #Decisioni #Equilibrio #Opinioni",
                "cta": "Vota e commenta!",
                "canale": "Instagram Feed",
                "timing": "GiovedÃ¬ sera, 18:00"
              }
            ]
          },
          "fase_2": {
            "nome": "MANTENERE HYPE",
            "posts": [
              {
                "titolo": "Il Futuro Ãˆ PiÃ¹ Vicino Di Quanto Pensi... ðŸ¤«",
                "testo": "Siete pronti a scoprire ciÃ² che cambierÃ  le regole del gioco? Abbiamo lavorato instancabilmente per creare qualcosa di rivoluzionario, e l'attesa Ã¨ quasi finita. Preparatevi a un'esperienza che supererÃ  ogni vostra aspettativa. Il conto alla rovescia Ã¨ iniziato! âœ¨",
                "hashtag": "#RivoluzioneImminente #GameChanger #StayTuned #NuoveVibrazioni",
                "cta": "Attiva le notifiche per non perderti nulla!",
                "canale": "Instagram Reels",
                "timing": "MartedÃ¬, ore 18:00"
              },
              {
                "titolo": "Cosa Vi Aspettate Dal Prossimo Livello? ðŸ¤”",
                "testo": "Abbiamo un'idea ben chiara di come stiamo per stupirvi, ma siamo curiosi: qual Ã¨ la vostra previsione piÃ¹ audace? La nostra community Ã¨ il cuore di tutto, e il vostro entusiasmo ci spinge a superare ogni limite. Diteci nei commenti cosa vi piacerebbe vedere! ðŸ‘‡",
                "hashtag": "#HypeTrain #CommunityPower #FuturoAdesso #Innovazione",
                "cta": "Condividi la tua visione!",
                "canale": "Facebook/Instagram Post",
                "timing": "GiovedÃ¬, ore 12:00"
              },
              {
                "titolo": "L'EsclusivitÃ  Chiama: Rispondi? ðŸ“ž",
                "testo": "Non tutti avranno la possibilitÃ  di essere tra i primi. Stiamo per aprire le porte a un'opportunitÃ  unica, riservata a chi Ã¨ pronto a cogliere il futuro al volo. Le liste si stanno riempiendo velocemente. Non rimandare, il tuo posto nel futuro ti aspetta. ðŸš€",
                "hashtag": "#EarlyBird #NonPerderlo #AccessoEsclusivo #Pionieri",
                "cta": "Iscriviti alla lista d'attesa VIP ora!",
                "canale": "Email/Landing Page CTA",
                "timing": "LunedÃ¬, ore 10:00"
              }
            ]
          },
          "fase_3": {
            "nome": "PRE-LANCIO",
            "posts": [
              {
                "titolo": "Il Futuro Sta Arrivando. E Non SarÃ  Come Te Lo Aspetti.",
                "testo": "Stanco delle solite promesse? Anche noi. Abbiamo lavorato in silenzio, spingendoci oltre ogni limite per creare qualcosa che non cambierÃ  solo il tuo modo di [settore/azione], ma lo ridefinirÃ  completamente. Non Ã¨ un aggiornamento, non Ã¨ un'evoluzione. Ãˆ una rivoluzione. E tu potresti essere tra i primi a viverla. Non perdere l'opportunitÃ  di scoprire cosa bolle in pentola prima di tutti. Il tempo stringe, e le novitÃ  sono davvero... inaspettate. Sii pronto a ridefinire le tue aspettative.",
                "hashtag": "#RivoluzioneImminente #FuturoOra #Anticipazione #NonÃˆIlSolito",
                "cta": "Iscriviti alla nostra lista VIP per ricevere aggiornamenti esclusivi prima del lancio!",
                "canale": "Email/Landing Page",
                "timing": "3-4 settimane prima del lancio"
              },
              {
                "titolo": "Accesso Esclusivo: La Tua OpportunitÃ  di Essere Avanti.",
                "testo": "La rivoluzione di cui ti abbiamo parlato si sta avvicinando. Ma prima che il mondo intero la scopra, vogliamo offrire un'opportunitÃ  unica a chi crede nell'innovazione autentica. Abbiamo riservato un numero limitato di posti per un'anteprima esclusiva, un'immersione profonda in ciÃ² che sta per cambiare le regole del gioco. Non Ã¨ solo un'anteprima, Ã¨ un invito a far parte del nostro cerchio piÃ¹ ristretto. Questa Ã¨ la tua occasione per toccare con mano il futuro e influenzarne la direzione, prima che sia troppo tardi. Le disponibilitÃ  sono contate, e l'interesse Ã¨ altissimo. Non rimandare, potresti perdere l'opportunitÃ  di una vita.",
                "hashtag": "#AccessoEsclusivo #EarlyAdopter #InnovazioneAutentica #PostiLimitati",
                "cta": "Richiedi ora il tuo posto per l'anteprima esclusiva e non perdere questa chance!",
                "canale": "Instagram Stories/Email/Landing Page",
                "timing": "2-3 settimane prima del lancio"
              },
              {
                "titolo": "Ultima Chiamata: Il Conto Alla Rovescia Ãˆ Iniziato.",
                "testo": "Mancano pochi giorni. La data di lancio si avvicina inesorabilmente e l'attesa Ã¨ palpabile. Se non ti sei ancora assicurato il tuo posto nella lista prioritaria per il lancio di [Nome Prodotto/Soluzione], questa Ã¨ la tua ULTIMA occasione. Non stiamo solo lanciando un prodotto; stiamo inaugurando una nuova era per [settore/beneficio]. Chi sarÃ  nella lista prioritaria riceverÃ  non solo l'accesso anticipato, ma anche bonus e offerte irripetibili pensate solo per i primi. Non lasciare che questa opportunitÃ  ti sfugga. Il tempo Ã¨ quasi scaduto. Agisci ora o potresti rimpiangerlo.",
                "hashtag": "#ContoAllaRovescia #UltimaChance #LancioImminente #NonPerderlo",
                "cta": "Iscriviti ora alla lista prioritaria e sii tra i primi a beneficiare della rivoluzione!",
                "canale": "Social Media (Post/Ads)/Email",
                "timing": "1 settimana prima del lancio"
              }
            ]
          },
          "review_text": "========================================\nBRAND TONE DA RISPETTARE:\n========================================\n\n\n========================================\nFASE 1: ENGAGEMENT INIZIALE\n========================================\n\nPOST 1: La sfida del lunedÃ¬ mattina?\nTesto: Tutti abbiamo quel momento in cui ci sentiamo bloccati o cerchiamo l'ispirazione giusta per iniziare la settimana. Qual Ã¨ la tua strategia segreta per superare gli ostacoli e dare il via alla giornata con la giusta energia? Condividi il tuo trucco del mestiere!\nHashtag: #InizioSettimana #Motivazione #ProduttivitÃ  #ConsigliUtili #Community\nCTA: Raccontaci la tua nei commenti!\nCanale: Instagram Feed\nTiming: LunedÃ¬ mattina, 9:00\n\nPOST 2: E se ci fosse un modo piÃ¹ semplice?\nTesto: Ti sei mai chiesto se esista una strada meno complessa per raggiungere i tuoi obiettivi? Spesso la soluzione Ã¨ a portata di mano, basta cambiare prospettiva. Qual Ã¨ l'ostacolo che ti sembra insormontabile in questo momento? Forse insieme possiamo trovare una nuova angolazione.\nHashtag: #NuoveProspettive #Innovazione #Soluzioni #Crescita #PensieroLaterale\nCTA: Qual Ã¨ la tua sfida attuale?\nCanale: LinkedIn\nTiming: MercoledÃ¬ pomeriggio, 14:30\n\nPOST 3: Scelta rapida: Organizzazione o SpontaneitÃ ?\nTesto: Nel lavoro o nella vita, preferisci pianificare ogni dettaglio o lasciarti guidare dall'istinto del momento? Entrambi gli approcci hanno i loro pro e contro. Vota nei commenti con 'Organizzazione' o 'SpontaneitÃ ' e dicci perchÃ©!\nHashtag: #StileDiVita #LavoroSmart #Decisioni #Equilibrio #Opinioni\nCTA: Vota e commenta!\nCanale: Instagram Feed\nTiming: GiovedÃ¬ sera, 18:00\n\n========================================\nFASE 2: MANTENERE HYPE\n========================================\n\nPOST 1: Il Futuro Ãˆ PiÃ¹ Vicino Di Quanto Pensi... ðŸ¤«\nTesto: Siete pronti a scoprire ciÃ² che cambierÃ  le regole del gioco? Abbiamo lavorato instancabilmente per creare qualcosa di rivoluzionario, e l'attesa Ã¨ quasi finita. Preparatevi a un'esperienza che supererÃ  ogni vostra aspettativa. Il conto alla rovescia Ã¨ iniziato! âœ¨\nHashtag: #RivoluzioneImminente #GameChanger #StayTuned #NuoveVibrazioni\nCTA: Attiva le notifiche per non perderti nulla!\nCanale: Instagram Reels\nTiming: MartedÃ¬, ore 18:00\n\nPOST 2: Cosa Vi Aspettate Dal Prossimo Livello? ðŸ¤”\nTesto: Abbiamo un'idea ben chiara di come stiamo per stupirvi, ma siamo curiosi: qual Ã¨ la vostra previsione piÃ¹ audace? La nostra community Ã¨ il cuore di tutto, e il vostro entusiasmo ci spinge a superare ogni limite. Diteci nei commenti cosa vi piacerebbe vedere! ðŸ‘‡\nHashtag: #HypeTrain #CommunityPower #FuturoAdesso #Innovazione\nCTA: Condividi la tua visione!\nCanale: Facebook/Instagram Post\nTiming: GiovedÃ¬, ore 12:00\n\nPOST 3: L'EsclusivitÃ  Chiama: Rispondi? ðŸ“ž\nTesto: Non tutti avranno la possibilitÃ  di essere tra i primi. Stiamo per aprire le porte a un'opportunitÃ  unica, riservata a chi Ã¨ pronto a cogliere il futuro al volo. Le liste si stanno riempiendo velocemente. Non rimandare, il tuo posto nel futuro ti aspetta. ðŸš€\nHashtag: #EarlyBird #NonPerderlo #AccessoEsclusivo #Pionieri\nCTA: Iscriviti alla lista d'attesa VIP ora!\nCanale: Email/Landing Page CTA\nTiming: LunedÃ¬, ore 10:00\n\n========================================\nFASE 3: PRE-LANCIO\n========================================\n\nPOST 1: Il Futuro Sta Arrivando. E Non SarÃ  Come Te Lo Aspetti.\nTesto: Stanco delle solite promesse? Anche noi. Abbiamo lavorato in silenzio, spingendoci oltre ogni limite per creare qualcosa che non cambierÃ  solo il tuo modo di [settore/azione], ma lo ridefinirÃ  completamente. Non Ã¨ un aggiornamento, non Ã¨ un'evoluzione. Ãˆ una rivoluzione. E tu potresti essere tra i primi a viverla. Non perdere l'opportunitÃ  di scoprire cosa bolle in pentola prima di tutti. Il tempo stringe, e le novitÃ  sono davvero... inaspettate. Sii pronto a ridefinire le tue aspettative.\nHashtag: #RivoluzioneImminente #FuturoOra #Anticipazione #NonÃˆIlSolito\nCTA: Iscriviti alla nostra lista VIP per ricevere aggiornamenti esclusivi prima del lancio!\nCanale: Email/Landing Page\nTiming: 3-4 settimane prima del lancio\n\nPOST 2: Accesso Esclusivo: La Tua OpportunitÃ  di Essere Avanti.\nTesto: La rivoluzione di cui ti abbiamo parlato si sta avvicinando. Ma prima che il mondo intero la scopra, vogliamo offrire un'opportunitÃ  unica a chi crede nell'innovazione autentica. Abbiamo riservato un numero limitato di posti per un'anteprima esclusiva, un'immersione profonda in ciÃ² che sta per cambiare le regole del gioco. Non Ã¨ solo un'anteprima, Ã¨ un invito a far parte del nostro cerchio piÃ¹ ristretto. Questa Ã¨ la tua occasione per toccare con mano il futuro e influenzarne la direzione, prima che sia troppo tardi. Le disponibilitÃ  sono contate, e l'interesse Ã¨ altissimo. Non rimandare, potresti perdere l'opportunitÃ  di una vita.\nHashtag: #AccessoEsclusivo #EarlyAdopter #InnovazioneAutentica #PostiLimitati\nCTA: Richiedi ora il tuo posto per l'anteprima esclusiva e non perdere questa chance!\nCanale: Instagram Stories/Email/Landing Page\nTiming: 2-3 settimane prima del lancio\n\nPOST 3: Ultima Chiamata: Il Conto Alla Rovescia Ãˆ Iniziato.\nTesto: Mancano pochi giorni. La data di lancio si avvicina inesorabilmente e l'attesa Ã¨ palpabile. Se non ti sei ancora assicurato il tuo posto nella lista prioritaria per il lancio di [Nome Prodotto/Soluzione], questa Ã¨ la tua ULTIMA occasione. Non stiamo solo lanciando un prodotto; stiamo inaugurando una nuova era per [settore/beneficio]. Chi sarÃ  nella lista prioritaria riceverÃ  non solo l'accesso anticipato, ma anche bonus e offerte irripetibili pensate solo per i primi. Non lasciare che questa opportunitÃ  ti sfugga. Il tempo Ã¨ quasi scaduto. Agisci ora o potresti rimpiangerlo.\nHashtag: #ContoAllaRovescia #UltimaChance #LancioImminente #NonPerderlo\nCTA: Iscriviti ora alla lista prioritaria e sii tra i primi a beneficiare della rivoluzione!\nCanale: Social Media (Post/Ads)/Email\nTiming: 1 settimana prima del lancio\n\n",
          "_loop_data": {
            "brand_tone": "",
            "iteration": 0,
            "original_fase_1_brief": "âš ï¸ Nessun post disponibile per questa fase.",
            "original_fase_2_brief": "âš ï¸ Nessun post disponibile per questa fase.",
            "original_fase_3_brief": "âš ï¸ Nessun post disponibile per questa fase.\n\n\n\nFine del Piano Editoriale\nTotale Post Generati: 0\nDocumento generato automaticamente dal workflow n8n"
          },
          "total_posts": 9,
          "timestamp": "2025-12-03T00:56:08.456Z"
        }
      }
    ],
    "Code in JavaScript1": [
      {
        "json": {
          "documento_completo": "========================================\nCONTENUTI FINALI - PIANO EDITORIALE\nSNEAKERS SOSTENIBILI\n========================================\n\nðŸ“… Generato il: 03 dicembre 2025 alle ore 00:45\nðŸ“Š Punteggio QualitÃ : N/A/10\nðŸ† Giudizio Finale: N/A\nðŸ”„ Iterazioni Effettuate: 1\n\n\n============================================================\nFASE 1: ENGAGEMENT INIZIALE\n============================================================\n\nâš ï¸ Nessun post disponibile per questa fase.\n\n\n============================================================\nFASE 2: MANTENERE HYPE\n============================================================\n\nâš ï¸ Nessun post disponibile per questa fase.\n\n\n============================================================\nFASE 3: PRE-LANCIO\n============================================================\n\nâš ï¸ Nessun post disponibile per questa fase.\n\n\n============================================================\nFine del Piano Editoriale\nTotale Post Generati: 0\nDocumento generato automaticamente dal workflow n8n\n============================================================\n\n",
          "brand_tone": "",
          "fase_1": {
            "nome": "ENGAGEMENT INIZIALE",
            "testo_completo": "âš ï¸ Nessun post disponibile per questa fase."
          },
          "fase_2": {
            "nome": "MANTENERE HYPE",
            "testo_completo": "âš ï¸ Nessun post disponibile per questa fase."
          },
          "fase_3": {
            "nome": "PRE-LANCIO",
            "testo_completo": "âš ï¸ Nessun post disponibile per questa fase.\n\n\n\nFine del Piano Editoriale\nTotale Post Generati: 0\nDocumento generato automaticamente dal workflow n8n"
          },
          "iteration": 0,
          "estratto_il": "2025-12-03T00:55:31.078Z"
        }
      }
    ]
  },
  "connections": {
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "Brand Strategist",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Brand Strategist",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Brand Strategist": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive Trigger": {
      "main": [
        [
          {
            "node": "Get a document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Create a document1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document1": {
      "main": [
        [
          {
            "node": "Update a document1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Engagement iniziale",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Mantenere hype",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Pre-lancio",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Engagement iniziale": {
      "main": [
        [
          {
            "node": "Code ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a document": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Mantenere hype": {
      "main": [
        [
          {
            "node": "Code 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pre-lancio": {
      "main": [
        [
          {
            "node": "Code 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code ": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code 2": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code 3": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Google Gemini Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "Revisore",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Revisore",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Revisore": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Formattare per docs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Formattare per docs": {
      "main": [
        [
          {
            "node": "Create a document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document": {
      "main": [
        [
          {
            "node": "Update a document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Engagement iniziale",
            "type": "main",
            "index": 0
          },
          {
            "node": "Mantenere hype",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pre-lancio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "e948bd20-4882-4257-bdff-02631f5ea069",
  "meta": {
    "instanceId": "5bf1f721c0376390fc3b5aeeae81ba20053b23e896e4a22291031cbf7b0c2a73"
  },
  "id": "qwWjL2Ecx3rHnSUv",
  "tags": []
}